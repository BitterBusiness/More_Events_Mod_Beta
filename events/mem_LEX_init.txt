namespace = mem_lex_init

country_event = {
	id = mem_lex_init.1
	hide_window = yes
	
	fire_only_once = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		NOT = {
			has_country_flag = encountered_mem_titan	
			has_country_flag = encountered_mem_grave
			has_country_flag = encountered_mem_conduit
			has_global_flag = mem_endgame_seed
		}
		has_technology = "tech_sensors_4"
	}
	
	mean_time_to_happen = {
		years = 100
		
		#modifier = {
		#	factor = 0.5
		#		any_owned_planet = {
		#			has_spaceport_module = "observatory"
		#		}	
		#}
		modifier = {
			factor = 0.25
				any_country = {
					has_country_flag = awakened_fallen_empire
				}	
		}
		modifier = {
			factor = 0.1
				has_global_flag = war_in_heaven_started
		}
		modifier = {
			factor = 0.1
				has_country_flag = vultaum_world_found
		}
		modifier = {
			factor = 0.1
				has_country_flag = yuht_homeworld_found
		}
		modifier = {
			factor = 0.1
				has_country_flag = league_world_found
		}
		modifier = {
			factor = 0.1
				has_country_flag = irassian_world_found
		}
		modifier = {
			factor = 0.1
				has_country_flag = cybrex_world_found
		}
		modifier = {
			factor = 0.01
				has_global_flag = ai_revolt_happened
		}
		modifier = {
			factor = 0.01
				has_global_flag = prethoryn_invasion_happened
		}
		modifier = {
			factor = 0.01
				has_global_flag = extradimensional_invasion_happened
		}
	}

	immediate = {	
		random_rim_system = {
			limit = {
				NOT = {
					OR = {
						has_star_flag = sanctuary_system
						has_star_flag = mem_ring_system
						has_star_flag = mem_grave_system
						has_star_flag = mem_garden_system
						has_star_flag = mem_system_spawn_1
						has_star_flag = mem_system_spawn_2
						has_star_flag = mem_system_spawn_3
					}
					is_fe_cluster = yes
				}
			}
			spawn_system = {
				min_distance = 20
				max_distance = 50
				initializer = "mem_ringworld"
			}
			set_star_flag = mem_system_spawn_1
		}
		random_rim_system = {
			limit = {
				NOT = {
					OR = {
						has_star_flag = sanctuary_system
						has_star_flag = mem_ring_system
						has_star_flag = mem_grave_system
						has_star_flag = mem_garden_system
						has_star_flag = mem_system_spawn_1
						has_star_flag = mem_system_spawn_2
						has_star_flag = mem_system_spawn_3
					}
					is_fe_cluster = yes
				}
			}
			spawn_system = {
				min_distance = 20
				max_distance = 50
				initializer = "mem_graveyard"
			}
			set_star_flag = mem_system_spawn_2
		}
		random_rim_system = {
			limit = {
				NOT = {
					OR = {
						has_star_flag = sanctuary_system
						has_star_flag = mem_ring_system
						has_star_flag = mem_grave_system
						has_star_flag = mem_garden_system
						has_star_flag = mem_system_spawn_1
						has_star_flag = mem_system_spawn_2
						has_star_flag = mem_system_spawn_3
					}
					is_fe_cluster = yes
				}
			}
			spawn_system = {
				min_distance = 20
				max_distance = 50
				initializer = "mem_garden"
			}
			set_star_flag = mem_system_spawn_3
		}
		set_global_flag = mem_endgame_seed
		country_event = { id = mem_lex_init.2 days = 10 } 
	}
}

country_event = {
	id = mem_lex_init.2
	title = "mem_lex_init.2.name"
	desc = "mem_lex_init.2.desc"
	picture = GFX_evt_wormhole
	show_sound = event_sensor_ping
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	immediate = {
		random_system = {
			limit = { has_star_flag = mem_ring_system }
			save_event_target_as = mem_ring_poi
		}
		random_system = {
			limit = { has_star_flag = mem_grave_system }
			save_event_target_as = mem_grave_poi
		}
		random_system = {
			limit = { has_star_flag = mem_garden_system }
			save_event_target_as = mem_garden_poi
		}
	}
	
	option = {
		name = "mem_lex_init.2.a"
		begin_event_chain = {
			event_chain = "mem_lex_ring_chain"
			target = ROOT
		}
		begin_event_chain = {
			event_chain = "mem_lex_grave_chain"
			target = ROOT
		}
		begin_event_chain = {
			event_chain = "mem_lex_garden_chain"
			target = ROOT
		}
		create_point_of_interest = {
			id = mem_lex_init_poi.1
			name = "mem_ring_guardian_poi"
			desc = "mem_ring_guardian_poi_desc"
			event_chain = mem_lex_ring_chain
			location = event_target:mem_ring_poi
		}
		create_point_of_interest = {
			id = mem_lex_init_poi.2
			name = "mem_grave_guardian_poi"
			desc = "mem_grave_guardian_poi_desc"
			event_chain = mem_lex_grave_chain
			location = event_target:mem_grave_poi
		}
		create_point_of_interest = {
			id = mem_lex_init_poi.3
			name = "mem_garden_guardian_poi"
			desc = "mem_garden_guardian_poi_desc"
			event_chain = mem_lex_garden_chain
			location = event_target:mem_garden_poi
		}
	}
}

country_event = {
	id = mem_lex_init.3
	hide_window = yes
	
	fire_only_once = yes
	
	trigger = {
		NOT = {
			has_global_flag = mem_ancestor_system_seed
		}
	}

	immediate = {	
		random_system = {
			limit = {
				is_fe_cluster = yes
			}
			spawn_system = {
				min_distance = 20
				max_distance = 50
				initializer = "mem_prison"
			}
		}
		set_global_flag = mem_ancestor_system_seed
	}
}