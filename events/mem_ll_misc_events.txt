#Miscellaneous events coded by LamilLerran

@tier1materialreward = 6
@tier1materialmin = 100
@tier1materialmax = 500
@tier2materialreward = 12
@tier2materialmin = 150
@tier2materialmax = 1000
@tier3materialreward = 18
@tier3materialmin = 250
@tier3materialmax = 1500
@tier4materialreward = 24
@tier4materialmin = 350
@tier4materialmax = 2000

@tier1influencereward = 6
@tier1influencemin = 40
@tier1influencemax = 100
@tier2influencereward = 12
@tier2influencemin = 80
@tier2influencemax = 175
@tier3influencereward = 18
@tier3influencemin = 125
@tier3influencemax = 250
@tier4influencereward = 24
@tier4influencemin = 150
@tier4influencemax = 300

@tier1researchreward = 6
@tier1researchmin = 60
@tier1researchmax = 150
@tier2researchreward = 12
@tier2researchmin = 90
@tier2researchmax = 250
@tier3researchreward = 18
@tier3researchmin = 120
@tier3researchmax = 350
@tier4researchreward = 24
@tier4researchmin = 150
@tier4researchmax = 500

namespace = mem_ll_misc_event

#Lost Zoo Anomaly
#Code and idea by LamilLerran
#Writing by shockedsystem
ship_event = {
	id = mem_ll_misc_event.1
	title = "mem_ll_misc_event.1.name"
	desc = "mem_ll_misc_event.1.desc"
	picture = GFX_evt_in_the_dark
	location = FROM
	is_triggered_only = yes
	
	option = {	#Reverse-engineer
		name = mem_ll_misc_event.1.a
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier1researchreward
				min = @tier1researchmin
				max = @tier1researchmax
			}
			if = {
				limit = {
					has_tech_option = tech_nutrient_replication
				}
				add_tech_progress = {
					tech = tech_nutrient_replication
					progress = 0.20
				}
				else = {
					add_research_option = tech_nutrient_replication
					add_tech_progress = {
						tech = tech_nutrient_replication
						progress = 0.05
					}
				}
			}
		}
	}
	option = {	#Dissection
		name = mem_ll_misc_event.1.b
		FROMFROMFROM = {
			orbital_deposit_tile = {
				add_deposit = d_enormous1_society_deposit
			}
		}
	}
	option = {	#Preserve
		name = mem_ll_misc_event.1.c
		trigger = {
			owner = {
				has_technology = tech_alien_life_studies
			}
		}
		FROMFROMFROM = {
			orbital_deposit_tile = {
				add_deposit = d_alien_pets_deposit
			}
		}
	}
}

#Viral Engine
#Writing and idea by shockedsystem
#Code by LamilLerran

#Start: Hidden Setup
country_event = {
	id = mem_ll_misc_event.9
	hide_window = yes
	
	mean_time_to_happen = { months = 2400 }
	
	trigger = {
		NOT = { has_country_flag = mem_viral_engine_started }
		num_owned_planets > 9
		any_owned_planet = { 
			is_capital = no
			num_pops > 4
			NOT = { 
				has_planet_flag = colony_event
			}
		}
	}
	
	immediate = {
		set_country_flag = mem_viral_engine_started
		random_owned_planet = { 
			limit = {
				is_capital = no
				num_pops > 4
				NOT = { 
					has_planet_flag = colony_event
				}
			}
			planet_event = { id = mem_ll_misc_event.10 days = 1 }
			save_event_target_as = mem_viral_engine_planet #TODO: Necessary?
			set_planet_flag = colony_event
		}
	}
}

#Initial Player Event
planet_event = {
	id = mem_ll_misc_event.10
	title = "mem_ll_misc_event.10.name"
	desc = "mem_ll_misc_event.10.desc"
	picture = GFX_evt_microscopic_life
	
	is_triggered_only = yes
	
	immediate = {
		add_modifier = {
			modifier = "mem_mysterious_illness"
			days = -1
		}
	}
	
	option = { #Quarantine
		name = mem_ll_misc_event.10.a
		planet_event = { id = mem_ll_misc_event.11 days = 120 random = 60 }
	}
}

#Aberrant Behavior
planet_event = {
	id = mem_ll_misc_event.11
	title = "mem_ll_misc_event.11.name"
	desc = "mem_ll_misc_event.11.desc"
	picture = GFX_evt_microscopic_life
	
	is_triggered_only = yes
	
	option = {
		name = mem_ll_misc_event.11.a
		enable_special_project = {
			name = "MEM_VIRAL_ENGINE_ISOLATE_PATHOGEN"
			location = this
			owner = owner	#TODO: Test
		}
	}
	option = {
		name = mem_ll_misc_event.11.b
		set_planet_flag = mem_viral_engine_research_fail
		planet_event = { id = mem_ll_misc_event.12 days = 720 random = 360 }
	}
}

#Successful Isolation
planet_event = {
	id = mem_ll_misc_event.14
	title = "mem_ll_misc_event.14.name"
	desc = "mem_ll_misc_event.14.desc"
	picture = GFX_evt_microscopic_life
	
	is_triggered_only = yes
	
	option = {
		name = mem_ll_misc_event.14.a
		planet_event = { id = mem_ll_misc_event.12 }
	}
}

#The Infected
planet_event = {
	id = mem_ll_misc_event.12
	title = "mem_ll_misc_event.12.name"
	desc = "mem_ll_misc_event.12.desc"
	picture = GFX_evt_microscopic_life

	is_triggered_only = yes
	
	#If this event is ever made possible to bypass, put this flag removal
	#along the alternate route as well.
	immediate = { remove_modifier = mem_mysterious_illness }
	
	option = {	#Generic
		name = mem_ll_misc_event.12.generic
		planet_event = { id = mem_ll_misc_event.13 }
	}
	option = { #Collectivist
		limit = {
			OR = {
				has_ethic = ethic_collectivist
				has_ethic = ethic_fanatic_collectivist
			}
		}
		name = mem_ll_misc_event.12.col
		custom_tooltip = mem_ll_misc_event.12.col.tooltip
		planet_event = { id = mem_ll_misc_event.16 }
	}
	option = { #Xenophobe
		limit = {
			OR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
		}
		name = mem_ll_misc_event.12.phobe
		custom_tooltip = mem_ll_misc_event.12.phobe.tooltip
		planet_event = { id = mem_ll_misc_event.16 }
	}
	option = { #Materialist
		limit = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
		}
		name = mem_ll_misc_event.12.mat
		enable_special_project = {
			name = "MEM_VIRAL_ENGINE_RESEARCH_CURE"
			location = this
			owner = owner	#TODO: Test
		}
	}
	option = { #Individualist
		limit = {
			OR = {
				has_ethic = ethic_individualist
				has_ethic = ethic_fanatic_individualist
			}
		}
		name = mem_ll_misc_event.12.ind
		enable_special_project = {
			name = "MEM_VIRAL_ENGINE_RESEARCH_CURE"
			location = this
			owner = owner	#TODO: Test
		}
	}
	option = { #Spiritualist
		limit = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
		}
		name = mem_ll_misc_event.12.spi
		planet_event = { id = mem_ll_misc_event.18 }
	}
	option = { #Xenophile
		limit = {
			OR = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
			}
		}
		name = mem_ll_misc_event.12.phile
		planet_event = { id = mem_ll_misc_event.18 }
	}
}

planet_event = { #After studying infected
	id = mem_ll_misc_event.13
	title = "mem_ll_misc_event.13.name"
	desc = "mem_ll_misc_event.13.desc"
	picture = GFX_evt_microscopic_life
	
	is_triggered_only = yes
	
	option = { #Let them finish
		name = mem_ll_misc_event.13.a
		planet_event = { id = mem_ll_misc_event.18 }
	}
	option = { #Stop this
		name = mem_ll_misc_event.13.b
		custom_tooltip = mem_ll_misc_event.13.b.tooltip		#Warn that it may cause purge
		planet_event = { id = mem_ll_misc_event.19 }
	}
}

planet_event = { #Ran out of time to study infected / research cure
	id = mem_ll_misc_event.15
	title = "mem_ll_misc_event.15.name"
	desc = "mem_ll_misc_event.15.desc"
	picture = GFX_evt_microscopic_life
	
	is_triggered_only = yes
	
	immediate = {
		set_planet_flag = mem_viral_engine_research_fail
	}
	
	option = {
		name = mem_ll_misc_event.15.a
		planet_event = { 
			id = mem_ll_misc_event.18
			days = 30 random = 30
		}
	}
}

#Sequester
planet_event = {
	id = mem_ll_misc_event.16
	title = "mem_ll_misc_event.16.name"
	desc = "mem_ll_misc_event.16.desc"
	picture = GFX_evt_interior_battle
	
	is_triggered_only = yes
	
	immediate = {
		add_modifier = { modifier = "mem_grateful_populace" days = 21600 }
		random_pop = { kill_pop = yes }
		random_pop = { kill_pop = yes }
	}
	
	option = {
		name = mem_ll_misc_event.16.a
	}
}

#Cure
planet_event = {
	id = mem_ll_misc_event.17
	title = "mem_ll_misc_event.17.name"
	desc = "mem_ll_misc_event.17.desc"
	picture = GFX_evt_microscopic_life
	
	is_triggered_only = yes
	
	option = {
		name = mem_ll_misc_event.17.a
		add_modifier = { modifier = "mem_medical_breakthrough" days = 21600 }
	}
}

#Viral Engine -- Determine Success/Fail
planet_event = {
	id = mem_ll_misc_event.18
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			40 = {
				modifier = {
					limit = { has_planet_flag = "mem_viral_engine_research_fail" }
					factor = 0.20
				}
				planet_event = { id = mem_ll_misc_event.22 }
			}
			10 = { planet_event = { id = mem_ll_misc_event.20 } }
			2  = { planet_event = { id = mem_ll_misc_event.21 } }
		}
	}
}

#Viral Engine -- Success
planet_event = {
	id = mem_ll_misc_event.22
	title = "mem_ll_misc_event.22.name"
	desc = "mem_ll_misc_event.22.desc"
	picture = GFX_evt_microscopic_life
	
	is_triggered_only = yes
	
	option = {
		name = mem_ll_misc_event.22.a
		if = {
			limit = {
				any_tile = { has_building = no }
			}
			random_tile = {
				limit = { has_building = no }
				set_building = building_viral_engine
			}
			else = {
				random_tile = { set_building = building_viral_engine }
			}
		}
	}
}

#Emergency Purge
planet_event = {
	id = mem_ll_misc_event.19
	title = "mem_ll_misc_event.19.name"
	desc = "mem_ll_misc_event.19.desc"
	picture = GFX_evt_interior_battle
	
	is_triggered_only = yes
	
	immediate = { 
		add_modifier = {
			modifier = "mem_viral_insurgency"
			days = 21600
		}
		random_pop = { kill_pop = yes }
	}
	
	option = {
		name = mem_ll_misc_event.19.a
	}
}

#Viral Transmitter
planet_event = {
	id = mem_ll_misc_event.20
	title = "mem_ll_misc_event.20.name"
	desc = "mem_ll_misc_event.20.desc"
	picture = GFX_evt_microscopic_life
	
	is_triggered_only = yes
	
	immediate = {
		random_tile = { set_blocker = mem_tb_viral_transmitter }
	}
	
	option = {
		name = mem_ll_misc_event.20.a
	}
}

#Viral Bomb
planet_event = {
	id = mem_ll_misc_event.21
	title = "mem_ll_misc_event.21.name"
	desc = "mem_ll_misc_event.21.desc"
	picture = GFX_evt_burning_settlement
	
	is_triggered_only = yes
	
	immediate = {
		random_pop = { kill_pop = yes }
		random_list = { 
			1 = {}
			8 = { random_pop = { kill_pop = yes } }
		}
		random_list = {
			1 = {}
			6 = { random_pop = { kill_pop = yes } }
		}
		random_list = {
			1 = {}
			4 = { random_pop = { kill_pop = yes } }
		}
		every_tile = {
			trigger = { has_building = yes }
			random_list = {
				3 = {}
				2 = { set_ruined = yes }
			}
		}
		add_modifier = {
			modifier = "mem_viral_insurgency"
			days = 21600
		}
	}
	
	option = {
		name = mem_ll_misc_event.21.a
	}
}
