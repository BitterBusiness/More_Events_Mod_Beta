#Hollow Asteroid
#Idea and writing by ViolentBeetle
#Code by Malthus

namespace = mem_hollow_asteroid

#Light failure
ship_event = {
	id = mem_hollow_asteroid.1
	title = mem_hollow_asteroid.1.name
	desc = mem_hollow_asteroid.1.desc
	picture = GFX_evt_mem_big_asteroid
	show_sound = event_ship_bridge
	location = FROM
	
	is_triggered_only = yes
	
	option = {
		name = mem_hollow_asteroid.1.a
	}
}

#Critical Failure
ship_event = {
	id = mem_hollow_asteroid.2
	title = mem_hollow_asteroid.2.name
	desc = mem_hollow_asteroid.2.desc
	picture = GFX_evt_exploding_ship
	show_sound = event_ship_explosion
	location = root
	
	is_triggered_only = yes
	
	immediate = {
		fleet = {
			set_event_locked = yes		
		}
	}
	
	option = {
		name = mem_hollow_asteroid.2.a
		kill_leader = { type = scientist show_notification = no }
		fleet = { destroy_fleet = this }
	}
}

#Success: Space Mausoleum
ship_event = {
	id = mem_hollow_asteroid.10
	title = mem_hollow_asteroid.10.name
	desc = mem_hollow_asteroid.10.desc
	picture = GFX_evt_in_the_dark
	show_sound = event_mystic_reveal
	location = FROM
	
	is_triggered_only = yes
	
	option = {
		name = mem_hollow_asteroid.10.a
		trigger = {
			owner = {
				NOR = {
					has_ethic = ethic_fanatic_materialist
					has_ethic = ethic_fanatic_spiritualist
					has_ethic = ethic_fanatic_xenophile
				}
			}
		}
		hidden_effect = {
			FROM = {
				orbital_deposit_tile = { clear_deposits = yes }
			}
		}
		FROM = { 
			orbital_deposit_tile = { 
				add_deposit = d_vast_society_deposit
			}
		}
	}
	
	option = {
		name = mem_hollow_asteroid.10.b
		trigger = {
			owner = {
				has_ethic = ethic_fanatic_materialist
			}
		}
		hidden_effect = {
			FROM = {
				orbital_deposit_tile = { clear_deposits = yes }
			}
		}
		FROM = { 
			orbital_deposit_tile = { 
				add_deposit = d_vast_society_deposit
			}
		}
	}
	
	option = {
		name = mem_hollow_asteroid.10.c
		trigger = {
			owner = {
				has_ethic = ethic_fanatic_spiritualist
			}
		}
		hidden_effect = {
			FROM = {
				orbital_deposit_tile = { clear_deposits = yes }
			}
		}
		FROM = { 
			orbital_deposit_tile = { 
				add_deposit = d_vast_society_deposit
			}
		}
	}
	
	option = {
		name = mem_hollow_asteroid.10.d
		trigger = {
			owner = {
				has_ethic = ethic_fanatic_xenophile
			}
		}
		hidden_effect = {
			FROM = {
				orbital_deposit_tile = { clear_deposits = yes }
			}
		}
		FROM = { 
			orbital_deposit_tile = { 
				add_deposit = d_vast_society_deposit
			}
		}
	}
}

#Success: Abandoned Space Resort
ship_event = {
	id = mem_hollow_asteroid.20
	title = mem_hollow_asteroid.20.name
	desc = mem_hollow_asteroid.20.desc
	picture = GFX_evt_archaeological_dig
	show_sound = event_mystic_reveal
	location = FROM
	
	is_triggered_only = yes
	
	option = {
		name = mem_hollow_asteroid.20.a
		trigger = {
			owner = {
				Not = {
					has_ethic = ethic_fanatic_collectivist
				}
			}
		}
		hidden_effect = {
			FROM = {
				orbital_deposit_tile = { clear_deposits = yes }
			}
		}
		FROM = { 
			orbital_deposit_tile = { 
				add_deposit = d_vast_energy_deposit
			}
		}
	}
	
	option = {
		name = mem_hollow_asteroid.20.b
		trigger = {
			owner = {
				Not = {
					has_ethic = ethic_fanatic_individualist
				}
			}
		}
		hidden_effect = {
			FROM = {
				orbital_deposit_tile = { clear_deposits = yes }
			}
		}
		owner = {
			add_modifier = {
				modifier = mem_hollow_asteroid_resort
				days = 1800
			}
		}
	}
	
	option = {
		name = mem_hollow_asteroid.20.c
		hidden_effect = {
			FROM = {
				orbital_deposit_tile = { clear_deposits = yes }
			}
		}
		FROM = { 
			orbital_deposit_tile = { 
				add_deposit = d_vast_engineering_deposit
			}
		}
	}
}

#Success: Ancient Art Exhibition
ship_event = {
	id = mem_hollow_asteroid.30
	title = mem_hollow_asteroid.30.name
	desc = mem_hollow_asteroid.30.desc
	picture = GFX_evt_in_the_dark
	show_sound = event_mystic_reveal
	location = FROM
	
	is_triggered_only = yes
	
	option = {
		name = mem_hollow_asteroid.30.a
		trigger = {
			owner = {
				NOR = {
					has_ethic = ethic_fanatic_materialist
					has_ethic = ethic_fanatic_spiritualist
					has_ethic = ethic_fanatic_xenophile
				}
			}
		}
		owner = {
			add_influence = 50
		}
	}
	
	option = {
		name = mem_hollow_asteroid.30.b
		trigger = {
			owner = {
				has_ethic = ethic_fanatic_materialist
			}
		}
		owner = {
			add_influence = 75
		}
	}
	
	option = {
		name = mem_hollow_asteroid.30.c
		trigger = {
			owner = {
				has_ethic = ethic_fanatic_spiritualist
			}
		}
		owner = {
			add_influence = 75
		}
	}
	
	option = {
		name = mem_hollow_asteroid.30.d
		trigger = {
			owner = {
				has_ethic = ethic_fanatic_xenophile
			}
		}
		owner = {
			add_influence = 75
		}
	}
}

#Success: Panopticon
ship_event = {
	id = mem_hollow_asteroid.40
	title = mem_hollow_asteroid.40.name
	desc = mem_hollow_asteroid.40.desc
	picture = GFX_evt_sentient_AI
	show_sound = event_airlock
	location = FROM
	
	is_triggered_only = yes
	
	option = {
		name = mem_hollow_asteroid.40.a
		hidden_effect = {
			FROM = {
				orbital_deposit_tile = { clear_deposits = yes }
			}
		}
		FROM = { 
			orbital_deposit_tile = { 
				add_deposit = d_vast_engineering_deposit
			}
		}
	}
}

#Success: Kraken Quest Start
ship_event = {
	id = mem_hollow_asteroid.50
	title = mem_hollow_asteroid.50.name
	desc = mem_hollow_asteroid.50.desc
	picture = GFX_evt_in_the_dark
	show_sound = event_ancient_drone
	location = FROM
	
	is_triggered_only = yes
	
	option = {
		name = mem_hollow_asteroid.50.a
		FROM = {
			enable_special_project = {
				name = MEM_HOLLOW_ASTEROID_KRAKEN
				location = this
				owner = root.owner
			}
		}
	}
}

#Project completed
ship_event = {
	id = mem_hollow_asteroid.51
	title = mem_hollow_asteroid.51.name
	desc = mem_hollow_asteroid.51.desc
	picture = GFX_evt_in_the_dark
	show_sound = event_laboratory_sound
	location = FROMFROM
	
	is_triggered_only = yes
	
	option = {
		name = mem_hollow_asteroid.51.a
		
	}
	
	option = {
		name = mem_hollow_asteroid.51.b
		
	}
}

#Success: Pirate Quest Start
ship_event = {
	id = mem_hollow_asteroid.100
	title = mem_hollow_asteroid.100.name
	desc = mem_hollow_asteroid.100.desc
	picture = GFX_evt_mem_asteroid_approach
	show_sound = event_red_alert
	location = FROMFROM

	is_triggered_only = yes

	immediate = {
		owner = {
			set_country_flag = mem_hollow_asteroid_pirates
		}
		FROMFROM = {
			set_planet_flag = mem_hollow_asteroid_pirate_base
			create_pirate_country = yes
			event_target:pirate_country = {
				create_fleet =  {
					name = "Pirate Scum"
					effect = {
						set_owner = event_target:pirate_country
#						create_ship = {
#							name = random
#							design = Corsair
#							graphical_culture = "pirate_01"
#						}
						create_ship = {
							name = random
							design = Vagabond
							graphical_culture = "pirate_01"
						}
						create_ship = {
							name = random
							design = Hunter
							graphical_culture = "pirate_01"
						}
						set_location = from
						set_fleet_stance = aggressive
						set_aggro_range_measure_from = self
						set_aggro_range = 150
					}
				}
				last_created_fleet = {
					set_fleet_flag = mem_hollow_asteroid_pirate_defenders
				}
				set_faction_hostility = {
					set_hostile = yes
				}
				establish_communications_no_message = root.owner
			}
		}
	}
	option = {
		name = mem_hollow_asteroid.100.a
	}
}

# This = owner of fleet 1 (combatant)
# From = owner of fleet 2 (destroyed)
# FromFrom = fleet 1
# FromFromFrom = fleet 2
#Triggered when the pirate fleet is destroyed
#Hidden event, as it is possible the pirate fleet gets destroyed by someone else
country_event = {
	id = mem_hollow_asteroid.101
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		FROMFROMFROM = {
			has_fleet_flag = mem_hollow_asteroid_pirate_defenders
		}
	}
	
	immediate = {
		random_country = {
			limit = {
				has_country_flag = mem_hollow_asteroid_pirates
				NOT = {
					has_country_flag = mem_hollow_asteroid_pirate_base
				}
			}
			country_event = { id = mem_hollow_asteroid.102 days = 1 }
		}
	}
}

country_event = {
	id = mem_hollow_asteroid.102
	title = mem_hollow_asteroid.102.name
	desc = mem_hollow_asteroid.102.desc
	picture = GFX_evt_mem_space_battle
	show_sound = event_space_battle
	
	option = {
		name = mem_hollow_asteroid.102.a
		random_planet = {
			limit = {
				has_planet_flag = mem_hollow_asteroid_pirate_base
			}
			enable_special_project = {
				name = MEM_HOLLOW_ASTEROID_PIRATES
				location = this
				owner = root
			}
		}
		hidden_effect = {
			random_planet = {
				limit = {
					has_planet_flag = mem_hollow_asteroid_pirate_base
				}
				remove_planet_flag = mem_hollow_asteroid_pirate_base
			}
			set_country_flag = mem_hollow_asteroid_pirate_base
		}
	}
}

ship_event = {
	id = mem_hollow_asteroid.103
	title = mem_hollow_asteroid.103.name
	desc = mem_hollow_asteroid.103.desc
	picture = GFX_evt_interior_battle
	show_sound = event_ground_battle
	
	is_triggered_only = yes
	
	immediate = {
		
	}
	
	option = {
		name = mem_hollow_asteroid.103.a
	}
}