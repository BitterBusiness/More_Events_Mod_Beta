namespace = mem_ancestor

# Ancestor Crisis - Children of Azoth
# Code & idea by Frog, writing by Cc

# Swarm generated on ship destruction

country_event = {
	id = mem_ancestor.1
	
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		FROMFROM = {
			OR = {
				is_ship_size = mem_apostle_1
				is_ship_size = mem_apostle_2
				is_ship_size = mem_apostle_3
				is_ship_size = mem_apostle_4
				is_ship_size = mem_apostle_egg
				is_ship_size = mem_apostle_child
				is_ship_size = mem_apostle_scout
				is_ship_size = mem_apostle_station
				is_ship_size = mem_apostle_xxl_cloud
				is_ship_size = mem_apostle_xl_cloud
				is_ship_size = mem_apostle_l_cloud
				is_ship_size = mem_apostle_m_cloud
			}
		}
	}
	
	immediate = {
		FROMFROM = {
			solar_system = {
				random_system_planet = {
					limit = { is_star = yes }
					save_event_target_as = mem_ancestor_spawn
				}
			}
			owner = {
				save_event_target_as = mem_ancestor_swarm_owner
			}
		}
		if = {
			limit = {
				FROMFROM = {
					OR = {
						is_ship_size = mem_apostle_1
						is_ship_size = mem_apostle_2
						is_ship_size = mem_apostle_3
						is_ship_size = mem_apostle_4
						is_ship_size = mem_apostle_egg
						is_ship_size = mem_apostle_child
						is_ship_size = mem_apostle_scout
						is_ship_size = mem_apostle_station
					}
				}
			}
			random_list = {
				10 = {
					mem_ancestor_infant = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				10 = {
					mem_ancestor_young = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				10 = {
					mem_ancestor_adult = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				10 = {
					mem_ancestor_elder = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				10 = {
					mem_ancestor_immortal = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				50 = {
				}
			}
		}
		if = {
			limit = {
				FROMFROM = {
					OR = {
						is_ship_size = mem_apostle_xxl_cloud
					}
				}
			}
			random_list = {
				12 = {
					mem_ancestor_infant = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				12 = {
					mem_ancestor_young = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				12 = {
					mem_ancestor_adult = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				12 = {
					mem_ancestor_elder = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				52 = {
				}
			}
		}
		if = {
			limit = {
				FROMFROM = {
					is_ship_size = mem_apostle_xl_cloud
				}
			}
			random_list = {
				16 = {
					mem_ancestor_infant = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				16 = {
					mem_ancestor_young = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				16 = {
					mem_ancestor_adult = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				52 = {
				}
			}
		}
		if = {
			limit = {
				FROMFROM = {
					is_ship_size = mem_apostle_l_cloud
				}
			}
			random_list = {
				25 = {
					mem_ancestor_infant = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				25 = {
					mem_ancestor_young = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				50 = {
				}
			}
		}
		if = {
			limit = {
				FROMFROM = {
					is_ship_size = mem_apostle_m_cloud
				}
			}
			random_list = {
				50 = {
					mem_ancestor_infant = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
				}
				50 = {
				}
			}
		}		
	}
}

# Swarm downgrade on death

country_event = {
	id = mem_ancestor.2
	
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		FROMFROMFROM = {
			OR = {
				is_ship_size = mem_apostle_4
				is_ship_size = mem_apostle_scout
				is_ship_size = mem_apostle_xxl_cloud
				is_ship_size = mem_apostle_xl_cloud
				is_ship_size = mem_apostle_l_cloud
				is_ship_size = mem_apostle_m_cloud
			}
		}
	}
	
	immediate = {
		FROMFROMFROM = {
			owner = {
				save_event_target_as = mem_ancestor_swarm_owner_1
			}
		}
		FROMFROM = {
			solar_system = {
				random_system_planet = {
					limit = { is_star = yes }
					save_event_target_as = mem_ancestor_spawn_1
				}
			}
		}
		if = {
			limit = {
				FROMFROMFROM = {
					OR = {
						is_ship_size = mem_apostle_scout
						is_ship_size = mem_apostle_station
						is_ship_size = mem_apostle_4
					}
				}
			}
			mem_ancestor_immortal_1 = yes
			last_created_fleet = {
				mem_effect_explosion_7 = yes
			}
			break = yes
		}
		if = {
			limit = {
				FROMFROMFROM = {
					is_ship_size = mem_apostle_xxl_cloud
				}
			}
			random_list = {
				50 = {
					mem_ancestor_elder_1 = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				50 = {
					break = yes
				}
			}
		}
		if = {
			limit = {
				FROMFROMFROM = {
					is_ship_size = mem_apostle_xl_cloud
				}
			}
			random_list = {
				50 = {
					mem_ancestor_adult_1 = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				50 = {
					break = yes
				}
			}
		}
		if = {
			limit = {
				FROMFROMFROM = {
					is_ship_size = mem_apostle_l_cloud
				}
			}
			random_list = {
				50 = {
					mem_ancestor_young_1 = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					break = yes
				}
				50 = {
					break = yes
				}
			}
		}
		if = {
			limit = {
				FROMFROMFROM = {
					is_ship_size = mem_apostle_m_cloud
				}
			}
			random_list = {
				50 = {
					mem_ancestor_infant_1 = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
				}
				50 = {
				}
			}
		}	
	}
}

# Leviathan evolves

country_event = {
	id = mem_ancestor.3
	
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = mem_ancestor_guardian
		has_country_flag = mem_ancestor_country
		NOT = {
			AND = {
				has_country_flag = mem_ancestor_evolve_1
				has_country_flag = mem_ancestor_evolve_2
				has_country_flag = mem_ancestor_evolve_3
				has_country_flag = mem_ancestor_evolve_4
			}
		}
		any_owned_ship = {
			OR = {
				is_ship_size = mem_apostle_1
				is_ship_size = mem_apostle_2
				is_ship_size = mem_apostle_3
				is_ship_size = mem_apostle_egg
			}
		}
	}
	
	immediate = {
		FROMFROM = {
			OWNER = {
				save_event_target_as = mem_ancestor_evolve_owner
			}
			save_event_target_as = mem_ancestor_evolve_spawn
		}
		if = {
			limit = {
				FROMFROM = {
					OWNER = {
						NOT = { has_country_flag = mem_ancestor_evolve_1 }
						count_owned_ships = {
							limit = {
								is_ship_size = mem_apostle_1
								FLEET = { is_same_value = event_target:mem_ancestor_evolve_spawn }
							}
							count > 0
						}
						num_owned_planets > 10
					}
				}
			}
			mem_ancestor_fanu_1 = yes
			FROMFROM = {
				OWNER = {
					add_modifier = {
						modifier = "mem_ancestor_buff_1"
						days = -1
					}
				}
				delete_fleet = this
			}
			last_created_fleet = {
				mem_effect_explosion_8 = yes
			}
			set_country_flag = mem_ancestor_evolve_1
			every_country = {
				limit = {
					is_ai = no
					is_country_type = default
				}
				country_event = { id = mem_ancestor.45 days = 10 }
			}
			break = yes
		}
		if = {
			limit = {
				FROMFROM = {
					OWNER = {
						has_country_flag = mem_ancestor_evolve_1
						NOT = { has_country_flag = mem_ancestor_evolve_2 }
						count_owned_ships = {
							limit = {
								is_ship_size = mem_apostle_2
								FLEET = { is_same_value = event_target:mem_ancestor_evolve_spawn }
							}
							count > 0
						}
						num_owned_planets > 20
					}
				}
			}
			mem_ancestor_fanu_2 = yes
			FROMFROM = {
				OWNER = {
					add_modifier = {
						modifier = "mem_ancestor_buff_2"
						days = -1
					}
				}
				delete_fleet = this
			}
			last_created_fleet = {
				mem_effect_explosion_8 = yes
			}
			set_country_flag = mem_ancestor_evolve_2
			break = yes
		}
		if = {
			limit = {
				FROMFROM = {
					OWNER = {
						AND = {
							has_country_flag = mem_ancestor_evolve_1
							has_country_flag = mem_ancestor_evolve_2
						}
						NOT = { has_country_flag = mem_ancestor_evolve_3 }
						count_owned_ships = {
							limit = {
								is_ship_size = mem_apostle_3
								FLEET = { is_same_value = event_target:mem_ancestor_evolve_spawn }
							}
							count > 0
						}
						num_owned_planets > 30
					}
				}
			}
			mem_ancestor_fanu_3 = yes
			mem_ancestor_thesan_1 = yes
			FROMFROM = {
				OWNER = {
					add_modifier = {
						modifier = "mem_ancestor_buff_3"
						days = -1
					}
				}
				delete_fleet = this
			}
			last_created_fleet = {
				mem_effect_explosion_8 = yes
			}
			set_country_flag = mem_ancestor_evolve_3
			every_country = {
				limit = {
					is_ai = no
					is_country_type = default
				}
				country_event = { id = mem_ancestor.46 days = 10 }
			}
			break = yes
		}
		if = {
			limit = {
				FROMFROM = {
					OWNER = {
						AND = {
							has_country_flag = mem_ancestor_evolve_1
							has_country_flag = mem_ancestor_evolve_2
							has_country_flag = mem_ancestor_evolve_3
						}
						NOT = { has_country_flag = mem_ancestor_evolve_4 }
						count_owned_ships = {
							limit = {
								is_ship_size = mem_apostle_egg
								FLEET = { is_same_value = event_target:mem_ancestor_evolve_spawn }
							}
							count > 0
						}
						num_owned_planets > 40
					}
				}
			}
			mem_ancestor_thesan_2 = yes
			FROMFROM = {
				OWNER = {
					add_modifier = {
						modifier = "mem_ancestor_buff_4"
						days = -1
					}
				}
				delete_fleet = this
			}
			last_created_fleet = {
				mem_effect_explosion_8 = yes
			}
			set_country_flag = mem_ancestor_evolve_4
			break = yes
		}
	}
}

# Swarm evolves

fleet_event = {
	id = mem_ancestor.4
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		THIS = {
			OWNER = {
				save_event_target_as = mem_ancestor_swarm_owner_2
			}
			save_event_target_as = mem_ancestor_spawn_2
		}
		if = {
			limit = {
				has_fleet_flag = mem_ancestor_infant_spawn
			}
			mem_ancestor_young_2 = yes
			last_created_fleet = {
				mem_effect_explosion_7 = yes
			}
			destroy_fleet = event_target:mem_ancestor_spawn_2
			break = yes
		}
		if = {
			limit = {
				has_fleet_flag = mem_ancestor_young_spawn
			}
			mem_ancestor_adult_2 = yes
			last_created_fleet = {
				mem_effect_explosion_7 = yes
			}
			destroy_fleet = event_target:mem_ancestor_spawn_2
			break = yes
		}
		if = {
			limit = {
				has_fleet_flag = mem_ancestor_adult_spawn
			}
			mem_ancestor_elder_2 = yes
			last_created_fleet = {
				mem_effect_explosion_7 = yes
			}
			destroy_fleet = event_target:mem_ancestor_spawn_2
			break = yes
		}
		if = {
			limit = {
				has_fleet_flag = mem_ancestor_elder_spawn
			}
			mem_ancestor_immortal_2 = yes
			last_created_fleet = {
				mem_effect_explosion_7 = yes
			}
			delete_fleet = event_target:mem_ancestor_spawn_2
			break = yes
		}
		if = {
			limit = {
				has_fleet_flag = mem_ancestor_dying_spawn
			}
			random_list = {
				50 = {
					mem_ancestor_infant_2 = yes
					last_created_fleet = {
						mem_effect_explosion_7 = yes
					}
					delete_fleet = event_target:mem_ancestor_spawn_2
					break = yes
				}
				50 = {
					break = yes
				}
			}
		}
		if = {
			limit = {
				has_fleet_flag = mem_ancestor_boss_decay
			}
			mem_ancestor_immortal_2 = yes
			last_created_fleet = {
				mem_effect_explosion_7 = yes
			}
			destroy_fleet = event_target:mem_ancestor_spawn_2
			break = yes
		}
	}
}

# Planet conversion

planet_event = {
	id = mem_ancestor.5
	hide_window = yes
	
	trigger = {
		FROM = {
			is_country_type = mem_ancestor_guardian
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		add_threat = {
			who = from
			amount = 1000
		}
		from = {
			save_event_target_as = mem_ancestor_swarm_owner_3
		}
		this = {
			solar_system = {
				if = {
					limit = {
						NOT = {
							any_ship_in_system = { 
								is_ship_size = mem_apostle_station
							}
						}
					}
					random_system_planet = {
						limit = { is_star = yes }
						save_event_target_as = mem_ancestor_spawn_3
						mem_ancestor_ward = yes
					}
				}
			}
		}
		create_ambient_object = {
			type = mem_effect_explosion_6_object
			location = THIS
			duration = 10
				
			use_3d_location = yes
				
			entity_offset = { min = 0 max = 0 }
			entity_offset_angle = { min = 0 max = 0 }
			entity_offset_height = { min = 0 max = 0 }
				
			entity_scale_to_size = yes
			scale = 100
		}
		random_list = {
			25 = {
				create_ambient_object = {
				type = "small_debris_object"
				location = THIS
				}
			}
			25 = {
				create_ambient_object = {
				type = "medium_debris_01_object"
				location = THIS
				}
			}
			25 = {
				create_ambient_object = {
				type = "medium_debris_02_object"
				location = THIS
				}
			}
			25 = {
				create_ambient_object = {
				type = "large_debris_object"
				location = THIS
				}
			}
		}
		OWNER = {
			country_event = { id = mem_ancestor.47 days = 10 }
		}
		if = {
			limit = {
				NOT = {
					OR = {
						is_planet_class = pc_gaia
						is_planet_class = pc_ringworld_habitable 
						is_planet_class = pc_mem_ringworld_habitable 
						has_planet_flag = fallen_empire_world
						has_modifier = holy_planet
					}
				}
			}
			destroy_colony = yes
			change_pc = pc_gaia
			set_owner = event_target:mem_ancestor_swarm_owner_3
			set_planet_flag = mem_ancestor_world
			every_tile = {
				set_blocker = tb_mem_nature
			}
			add_resource = { 
				resource = sr_alien_pets
				amount = 1 
			}
			break = yes
		}
		if = {
			limit = {
					has_planet_flag = fallen_empire_world
					NOT = {
						is_planet_class = pc_ringworld_habitable
					}
			}
			destroy_colony = yes
			change_pc = pc_nuked
			every_tile = {
				set_building = mem_building_crisis_ruin
			}
			add_resource = { 
				resource = sr_betharian
				amount = 1
			}
			break = yes
		}
		if = {
			limit = {
				has_modifier = holy_planet 
			}
			destroy_colony = yes
			change_pc = pc_mem_cracked	
			set_planet_max_health = 0
			add_resource = { 
				resource = sr_dark_matter
				amount = 1
			}
			break = yes
		}
		if = {
			limit = {
				OR = {
					is_planet_class = pc_ringworld_habitable 
					is_planet_class = pc_mem_ringworld_habitable 
				}
			}
			destroy_colony = yes
			change_pc = pc_ringworld_habitable_damaged
			set_planet_max_health = 0
			add_resource = { 
				resource = sr_living_metal
				amount = 1
			}
		}
	}
}

# Player planet reclamation

planet_event = {
	id = mem_ancestor.6
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_planet_flag = mem_ancestor_world
	}
	
	immediate = {
		THIS = {
			solar_system = {
				random_system_planet = {
					limit = { is_star = yes }
					save_event_target_as = mem_ancestor_spawn_4
				}
			}
			OWNER = {
			save_event_target_as = mem_ancestor_swarm_owner_4
			}
		}
		mem_ancestor_immortal_3 = yes
		destroy_colony = yes
		set_planet_max_health = 0
		remove_planet_flag = mem_ancestor_world
		create_ambient_object = {
			type = mem_effect_explosion_6_object
			location = THIS
			duration = 10
				
			use_3d_location = yes
				
			entity_offset = { min = 0 max = 0 }
			entity_offset_angle = { min = 0 max = 0 }
			entity_offset_height = { min = 0 max = 0 }
				
			entity_scale_to_size = yes
			scale = 100
		}
		random_list = {
			25 = { change_pc = pc_nuked }
			25 = { change_pc = pc_toxic }
			25 = { change_pc = pc_molten }
			25 = { change_pc = pc_barren }
		}
		FROM = {
			country_event = { id = mem_ancestor.48 days = 10 }
		}
	}
}

fleet_event = {
	id = mem_ancestor.8
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		queue_actions = {
			repeat = {
				max_iterations = 2
				find_closest_system = {
					trigger = {
						id = mem_ancestor_monstrosity.roam.1
						OR = {
							any_ship_in_system = {
								exists = owner
								NOT = {
									owner = {
										is_same_value = event_target:mem_ancestor_country
									}
								}
							}
							AND = {
								exists = space_owner
								any_planet = {
									OR = {
										has_spaceport = yes  
										has_observation_outpost = yes
										has_mining_station = yes
										has_research_station = yes 
									}
								}
								NOT = {
									space_owner = {
										is_same_value = event_target:mem_ancestor_country
									}
								}
							}
							any_planet = {
								is_colonizable = yes
							}
						}
						NOT = {
							OR = {
								has_star_flag = mem_ring_system
								has_star_flag = mem_grave_system
								has_star_flag = mem_garden_system
								has_star_flag = mem_prison_system
							}
							any_ship_in_system = {
								is_ship_size = mem_apostle_xxl_cloud 
							}
						}
					}
					found_system = {
						move_to = this
						
						find_closest_planet = {
							trigger = {
								id = mem_ancestor_monstrosity.roam.2
								OR = {
									is_star = yes
									has_spaceport = yes  
									has_observation_outpost = yes
									has_mining_station = yes
									has_research_station = yes 
								}
							}
							found_planet = {
								move_to = this
								wait = {
									duration = 25
									random = 15
								}
							}
						}
					}
				}
			}
		}
	}
}

fleet_event = {
	id = mem_ancestor.9
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		queue_actions = {
			repeat = {
				find_random_system = {
					trigger = {
						id = mem_ancestor_herald.roam.1a
						OR = {
							any_ship_in_system = {
								exists = owner
								NOT = {
									owner = {
										is_same_value = event_target:mem_ancestor_country
									}
								}
							}
							AND = {
								exists = space_owner
								any_planet = {
									OR = {
										has_spaceport = yes  
										has_observation_outpost = yes
										has_mining_station = yes
										has_research_station = yes 
									}
								}
								NOT = {
									space_owner = {
										is_same_value = event_target:mem_ancestor_country
									}
								}
							}
							any_planet = {
								is_colonizable = yes
							}
						}
						NOT = {
							OR = {
								has_star_flag = mem_ring_system
								has_star_flag = mem_grave_system
								has_star_flag = mem_garden_system
								has_star_flag = mem_prison_system
							}
							any_ship_in_system = {
								is_ship_size = mem_apostle_scout 
							}
						}
					}
					found_system = {
						move_to = this
						
						find_closest_planet = {
							trigger = {
								id = mem_ancestor_herald.roam.1b
								OR = {
									is_star = yes
									has_spaceport = yes  
									has_observation_outpost = yes
									has_mining_station = yes
									has_research_station = yes 
								}
							}
							found_planet = {
								move_to = this
								wait = {
									duration = 45
									random = 25
								}
							}
						}
					}
				}
			}
		}
	}
}

fleet_event = {
	id = mem_ancestor.10
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
	}
}

#Seal bursts

ship_event = {
	id = mem_ancestor.20
	hide_window = yes
	
	is_triggered_only = yes

	trigger = {
		is_ship_size = mem_apostle_seal
	}

	immediate = {
		from = {
			owner = {
				if = {
					limit = {
						NOT = {
							has_country_flag = mem_ancestor_seal_destroyer
						}
					}
				}
				set_country_flag = mem_ancestor_seal_destroyer
			}
		}
		every_country = {
			limit = {
				is_ai = no
				is_country_type = default
			}
			country_event = { id = mem_ancestor.41 days = 10 }
		}
		mem_ancestor_seal_change_1 = yes
		mem_ancestor_seal_change_2 = yes
		mem_ancestor_seal_change_3 = yes
		mem_ancestor_seal_change_4 = yes
		mem_ancestor_seal_change_5 = yes
		mem_ancestor_seal_change_6 = yes
		
	}
}

#Seal turns into miniature black hole

planet_event = {
	id = mem_ancestor.21
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_system = {
			limit = {
				has_star_flag = mem_prison_system
			}
			save_event_target_as = mem_prison_system
			every_system_ambient_object = {
				if = {
					limit = {
						has_ambient_object_flag = mem_ancestor_seal_1_burst
					}
					this = {
						mem_effect_explosion_2 = yes
					}
					event_target:mem_prison_system = {
						every_system_planet = {
							limit = { has_planet_flag = mem_ancestor_prison_planet_1 }
							orbital_deposit_tile = {
								clear_deposits = yes
							}
							orbital_deposit_tile = {
								add_deposit = d_mem_seal_exhausted
							}
							change_pc = pc_black_hole
							mem_ancestor_clear_station = yes	
						}
					}
					destroy_ambient_object = this
					set_global_flag = mem_ancestor_seal_1_global
					mem_ancestor_seal_chain = yes
					break = yes
				}
				if = {
					limit = {
						has_ambient_object_flag = mem_ancestor_seal_2_burst
					}
					this = {
						mem_effect_explosion_2 = yes
					}
					event_target:mem_prison_system = {
						every_system_planet = {
							limit = { has_planet_flag = mem_ancestor_prison_planet_2 }
							orbital_deposit_tile = {
								clear_deposits = yes
							}
							orbital_deposit_tile = {
								add_deposit = d_mem_seal_exhausted
							}
							change_pc = pc_black_hole
							mem_ancestor_clear_station = yes
						}
					}
					destroy_ambient_object = this
					set_global_flag = mem_ancestor_seal_2_global
					mem_ancestor_seal_chain = yes
					break = yes
				}
				if = {
					limit = {
						has_ambient_object_flag = mem_ancestor_seal_3_burst
					}
					this = {
						mem_effect_explosion_2 = yes
					}
					event_target:mem_prison_system = {
						every_system_planet = {
							limit = { has_planet_flag = mem_ancestor_prison_planet_3 }
							orbital_deposit_tile = {
								clear_deposits = yes
							}
							orbital_deposit_tile = {
								add_deposit = d_mem_seal_exhausted
							}
							change_pc = pc_black_hole
							mem_ancestor_clear_station = yes
						}
					}
					destroy_ambient_object = this
					set_global_flag = mem_ancestor_seal_3_global
					mem_ancestor_seal_chain = yes
					break = yes
				}
				if = {
					limit = {
						has_ambient_object_flag = mem_ancestor_seal_4_burst
					}
					this = {
						mem_effect_explosion_2 = yes
					}
					event_target:mem_prison_system = {
						every_system_planet = {
							limit = { has_planet_flag = mem_ancestor_prison_planet_4 }
							orbital_deposit_tile = {
								clear_deposits = yes
							}
							orbital_deposit_tile = {
								add_deposit = d_mem_seal_exhausted
							}
							change_pc = pc_black_hole
							mem_ancestor_clear_station = yes
						}
					}
					destroy_ambient_object = this
					set_global_flag = mem_ancestor_seal_4_global
					mem_ancestor_seal_chain = yes
					break = yes
				}
				if = {
					limit = {
						has_ambient_object_flag = mem_ancestor_seal_5_burst
					}
					this = {
						mem_effect_explosion_2 = yes
					}
					event_target:mem_prison_system = {
						every_system_planet = {
							limit = { has_planet_flag = mem_ancestor_prison_planet_5 }
							orbital_deposit_tile = {
								clear_deposits = yes
							}
							orbital_deposit_tile = {
								add_deposit = d_mem_seal_exhausted
							}
							change_pc = pc_black_hole
							mem_ancestor_clear_station = yes
						}
					}
					destroy_ambient_object = this
					set_global_flag = mem_ancestor_seal_5_global
					mem_ancestor_seal_chain = yes
					break = yes
				}
				if = {
					limit = {
						has_ambient_object_flag = mem_ancestor_seal_6_burst
					}
					this = {
						mem_effect_explosion_2 = yes
					}
					event_target:mem_prison_system = {
						every_system_planet = {
							limit = { has_planet_flag = mem_ancestor_prison_planet_6 }
							orbital_deposit_tile = {
								clear_deposits = yes
							}
							orbital_deposit_tile = {
								add_deposit = d_mem_seal_exhausted
							}
							change_pc = pc_black_hole
							mem_ancestor_clear_station = yes
						}
					}
					destroy_ambient_object = this
					set_global_flag = mem_ancestor_seal_6_global
					mem_ancestor_seal_chain = yes
					break = yes
				}
			}
		}
	}
}

# Tesseract init

country_event = {
	id = mem_ancestor.22
	hide_window = yes
	fire_only_once = yes
	
	trigger = {
		AND = {
			has_global_flag = mem_ancestor_seal_1_global
			has_global_flag = mem_ancestor_seal_2_global
			has_global_flag = mem_ancestor_seal_3_global
			has_global_flag = mem_ancestor_seal_4_global
			has_global_flag = mem_ancestor_seal_5_global
			has_global_flag = mem_ancestor_seal_6_global
		}
	}

	immediate = {
		random_system = {
			limit = {
				has_star_flag = mem_prison_system
			}
			save_event_target_as = mem_prison_system_local
			every_system_ambient_object = { 
				limit = {
					has_ambient_object_flag = mem_ancestor_prison_ambient
				}
				this = {
				 save_event_target_as = mem_ancestor_prison_failure_1
				}
				create_ambient_object = {
					type = "mem_prison_weakened_1_object"
				}
				last_created_ambient_object = {
					set_location = event_target:mem_ancestor_prison_failure_1
					set_ambient_object_flag = mem_ancestor_prison_weakened_1
				}
				create_ambient_object = {
					type = mem_effect_explosion_2_object
					duration = 10
					
					use_3d_location = yes
					
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
					
					entity_scale_to_size = yes
					scale = 100
				}
				last_created_ambient_object = {
					set_location = event_target:mem_ancestor_prison_failure_1
				}
				destroy_ambient_object = this
			}
			every_system_planet = {
				limit = {
					has_planet_flag = mem_ancestor_prison_star 
				}
				orbital_deposit_tile = {
					add_deposit = d_mem_prison_1
				}
			}
		}
		every_country = {
			limit = {
				is_ai = no
				is_country_type = default
			}
			country_event = { id = mem_ancestor.42 days = 10 }
		}
		country_event = { id = mem_ancestor.23 days = 1800 }
	}
}

# Tesseract Stage 2

country_event = {
	id = mem_ancestor.23
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_system = {
			limit = {
				has_star_flag = mem_prison_system
			}
			every_system_ambient_object = { 
				limit = {
					has_ambient_object_flag = mem_ancestor_prison_weakened_1
				}
				this = {
				 save_event_target_as = mem_ancestor_prison_failure_2
				}
				create_ambient_object = {
					type = "mem_prison_weakened_2_object"
				}
				last_created_ambient_object = {
					set_location = event_target:mem_ancestor_prison_failure_2
					set_ambient_object_flag = mem_ancestor_prison_weakened_2
				}
				create_ambient_object = {
					type = mem_effect_explosion_2_object
					duration = 10
					
					use_3d_location = yes
					
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
					
					entity_scale_to_size = yes
					scale = 100
				}
				last_created_ambient_object = {
					set_location = event_target:mem_ancestor_prison_failure_2
				}
				destroy_ambient_object = this
			}
			every_system_planet = {
				limit = {
					has_planet_flag = mem_ancestor_prison_star 
				}
				orbital_deposit_tile = {
					clear_deposits = yes
				}
				orbital_deposit_tile = {
					add_deposit = d_mem_prison_2
				}
				mem_ancestor_clear_station = yes
			}
		}
		country_event = { id = mem_ancestor.24 days = 1800 }
	}
}

# Tesseract Stage 3

country_event = {
	id = mem_ancestor.24
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_system = {
			limit = {
				has_star_flag = mem_prison_system
			}
			every_system_ambient_object = { 
				limit = {
					has_ambient_object_flag = mem_ancestor_prison_weakened_2
				}
				this = {
				 save_event_target_as = mem_ancestor_prison_failure_3
				}
				create_ambient_object = {
					type = "mem_prison_damaged_object"
				}
				last_created_ambient_object = {
					set_location = event_target:mem_ancestor_prison_failure_3
					set_ambient_object_flag = mem_ancestor_prison_weakened_3
				}
				create_ambient_object = {
					type = mem_effect_explosion_2_object
					duration = 10
					
					use_3d_location = yes
					
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
					
					entity_scale_to_size = yes
					scale = 100
				}
				last_created_ambient_object = {
					set_location = event_target:mem_ancestor_prison_failure_3
				}
				destroy_ambient_object = this
			}
			every_system_planet = {
				limit = {
					has_planet_flag = mem_ancestor_prison_star 
				}
				orbital_deposit_tile = {
					clear_deposits = yes
				}
				orbital_deposit_tile = {
					add_deposit = d_mem_prison_3
				}
				mem_ancestor_clear_station = yes
			}
		}
		country_event = { id = mem_ancestor.25 days = 1800 }
	}
}

# Massive black hole appears.

country_event = {
	id = mem_ancestor.25
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_system = {
			limit = {
				has_star_flag = mem_prison_system
			}
			save_event_target_as = mem_prison_system_local
			every_system_ambient_object = { 
				limit = {
					has_ambient_object_flag = mem_ancestor_prison_weakened_3
				}
				destroy_ambient_object = this
			}
			every_system_planet = {
				limit = {
					has_planet_flag = mem_ancestor_prison_star
				}
				change_pc = pc_black_hole
				change_planet_size = 100
				orbital_deposit_tile = {
					clear_deposits = yes
				}
				orbital_deposit_tile = {
					add_deposit = d_mem_prison_exhausted
				}
				mem_effect_explosion_6_big = yes
				mem_ancestor_clear_station = yes
			}
			every_system_planet = {
				limit = {
					OR = {
						has_planet_flag = mem_ancestor_prison_planet_1
						has_planet_flag = mem_ancestor_prison_planet_2
						has_planet_flag = mem_ancestor_prison_planet_3
						has_planet_flag = mem_ancestor_prison_planet_4
						has_planet_flag = mem_ancestor_prison_planet_5
						has_planet_flag = mem_ancestor_prison_planet_6
					}
				}
				change_pc = pc_mem_planet_dummy
				orbital_deposit_tile = {
					clear_deposits = yes
				}
				mem_ancestor_clear_station = yes
			}
			every_fleet_in_system = {
				destroy_fleet = this
			}
		}
		every_country = {
			limit = {
				is_ai = no
				is_country_type = default
			}
			country_event = { id = mem_ancestor.43 days = 10 }
		}
		country_event = { id = mem_ancestor.27 days = 360 }
		set_global_flag = mem_ancestor_black_hole
	}
}

#Super Massive Black Hole destroys fleet

fleet_event = {
	id = mem_ancestor.26
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = mem_ancestor_black_hole
		OWNER = {
			NOT = {
				is_country_type = mem_ancestor_guardian
			}
		}
	}
	
	immediate = {
		destroy_fleet = THIS
	}
}

country_event = {
	id = mem_ancestor.27
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = mem_ancestor_crisis_start
		}
	}
	
	immediate =  {
		random_system = {
			limit = {
				has_star_flag = mem_prison_system
			}
			random_system_planet = {
				limit = {
					has_planet_flag = mem_ancestor_prison_star
				}
				save_global_event_target_as = mem_ancestor_escape
				create_country = {
					name = "Chosen of Thesan"
					type = mem_ancestor_guardian
					flag = {
						icon = {
							category = "ornate"
							file = "flag_ornate_23.dds"
						}
						background= {
							category = "backgrounds"
							file = "00_solid.dds"
						}
						 colors={
							"pink"
							"pink"
							"null"
							"null"
						}
					}
				}
				last_created_country = {
					if = {
						limit = {
							NOT = {
								has_modifier = mem_ancestor_power
							}
						}
						add_modifier = {
							modifier = mem_ancestor_power
							days = -1
						}
					}
					save_global_event_target_as = mem_ancestor_country
					set_country_flag = mem_ancestor_country
					set_graphical_culture = fallen_empire_01
					guardian_difficulty = yes
				}
				mem_effect_explosion_6_big = yes
				mem_ancestor_vessel_init = yes
				mem_ancestor_herald_1 = yes
				mem_ancestor_herald_2 = yes
				mem_ancestor_herald_3 = yes
				mem_ancestor_herald_4 = yes
				mem_ancestor_herald_5 = yes
				mem_ancestor_herald_6 = yes
			}
		}
		every_country = {
			if = {
				limit = {
					is_ai = no
					is_country_type = default
				}
				country_event = { id = mem_ancestor.44 }
				establish_communications_no_message = event_target:mem_ancestor_country
			}
			if = {
				limit = {
					OR = {
						is_country_type = fallen_empire
						is_country_type = awakened_fallen_empire
					}
				}
				country_event = { id = mem_ancestor.28 days = 30 }
			}
		}
		set_global_flag = mem_ancestor_crisis_start
	}
}

country_event = {
	id = mem_ancestor.28
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		any_country = {
			OR = {
				has_country_flag = mem_ancestor_seal_destroyer
				has_country_flag = mem_titan_slayer
				has_country_flag = mem_grave_slayer
				has_country_flag = mem_conduit_slayer
			}
		}
	}

	immediate = {
		this = {
			save_event_target_as = mem_ancestor_fallen
		}
		if = {
			limit = {
				is_country_type = fallen_empire
			}
			country_event = { id = mem_ancestor.29 }
		}
		random_country = {
			limit = {
				OR = {
					has_country_flag = mem_ancestor_seal_destroyer
					has_country_flag = mem_titan_slayer
					has_country_flag = mem_grave_slayer
					has_country_flag = mem_conduit_slayer
				}
			}
			save_event_target_as = mem_ancestor_sealing_war_target
		}
		if = {
			limit = {
				NOT = {
					has_communications = event_target:mem_ancestor_sealing_war_target
				}
			}
			establish_communications_no_message = event_target:mem_ancestor_sealing_war_target
		}
		declare_war = {
			who = event_target:mem_ancestor_sealing_war_target
			major_war = yes
			name = "War Of Sealing"
		}
		add_war_demand = {
			type = "total_defeat"
			parameter:country = event_target:mem_ancestor_sealing_war_target
			warscore_cost = 75
			target = this
			enemy = event_target:mem_ancestor_sealing_war_target
		}
		event_target:mem_ancestor_sealing_war_target = {
			country_event = { id = mem_ancestor.49 }
		}
	}
}

country_event = {
	id = mem_ancestor.29
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_country_flag = sleepers_awake_first_sleeper
		set_country_type = awakened_fallen_empire
		change_government = awakened_ascendancy

		add_minerals = 20000
		add_energy = 10000
		add_influence = 1000
		
		while = {
			count = 7
			country_event = { id = fallen_empires.13 }
		}

		every_country = {
			limit = {
				OR = {
					is_country_type = fallen_empire
					is_country_type = awakened_fallen_empire
				}		
				NOT = { has_communications = root }
			}
			establish_communications_no_message = root	
			root = { save_event_target_as = contact_empire }
			country_event = { id = action.1 }				
		}
	}
}

country_event = {
	id = mem_ancestor.30
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			AND = {
				has_global_flag = mem_ancestor_seal_1_global
				has_global_flag = mem_ancestor_seal_2_global
				has_global_flag = mem_ancestor_seal_3_global
				has_global_flag = mem_ancestor_seal_4_global
				has_global_flag = mem_ancestor_seal_5_global
				has_global_flag = mem_ancestor_seal_6_global
			}
		}
	}

	immediate = {
		every_country = { 
			if = {
				limit = {
					has_country_flag = mem_prison_country
				}
				every_owned_ship = {
				mem_ancestor_seal_change_1 = yes
				mem_ancestor_seal_change_2 = yes
				mem_ancestor_seal_change_3 = yes
				mem_ancestor_seal_change_4 = yes
				mem_ancestor_seal_change_5 = yes
				mem_ancestor_seal_change_6 = yes
				}
			}
		}		
	}
}

# Entering system

ship_event = {
	id = mem_ancestor.40
	title = "mem_ancestor.40"
	desc = "mem_ancestor.40.desc"
	picture = GFX_evt_city_ruins
	show_sound = event_mystic_reveal_light
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			OR = {
				has_global_flag = mem_ancestor_seal_1_global
				has_global_flag = mem_ancestor_seal_2_global
				has_global_flag = mem_ancestor_seal_3_global
				has_global_flag = mem_ancestor_seal_4_global
				has_global_flag = mem_ancestor_seal_5_global
				has_global_flag = mem_ancestor_seal_6_global
				has_global_flag = mem_ancestor_crisis_start
			}
		}
		owner = {
			NOT = {
			has_country_flag = mem_ancestor_seal_destroyer
			has_country_flag = encountered_mem_prison 
			}
			is_ai = no
		}
		FROM = {
			has_star_flag = mem_prison_system
			any_ship = { 
				AND = {
					is_ship_size = mem_apostle_seal
					owner = { is_country_type = mem_prison_passive }
				}
			}
		}
	}
	
	immediate = {
		from = {
			save_event_target_as = mem_prison_loc
		}
		owner = {
			establish_communications_no_message = event_target:mem_prison_country_1
			establish_communications_no_message = event_target:mem_prison_country_2
			establish_communications_no_message = event_target:mem_prison_country_3
			establish_communications_no_message = event_target:mem_prison_country_4
			establish_communications_no_message = event_target:mem_prison_country_5
			establish_communications_no_message = event_target:mem_prison_country_6
			set_country_flag = encountered_mem_prison
		}
	}	
	
	option = {
		name =  CURIOUS
	}
}

# Notification - seal busted

country_event = {
	id = mem_ancestor.41
	title = "mem_ancestor.41"
	desc = "mem_ancestor.41.desc"
	picture = GFX_evt_star_pulsar
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = mem_ancestor_seal_destroyer
		NOT = {
			has_country_flag = mem_ancestor_seal_notification
		}
	}
	
	immediate = {
		set_country_flag = mem_ancestor_seal_notification
	}
	
	option = {
		name = "mem_ancestor.41.a"
	}
}

# Notification - tesseract breaks down

country_event = {
	id = mem_ancestor.42
	title = "mem_ancestor.42"
	desc = "mem_ancestor.42.desc"
	picture = GFX_evt_physics_research
	location = event_target:mem_prison_system_local
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_country_flag = mem_ancestor_prison_notification
		}
	}
	
	immediate = {
		set_country_flag = mem_ancestor_prison_notification
	}
	
	option = {
		name = "mem_ancestor.42.a"
	}
}

# Notification - tesseract explodes

country_event = {
	id = mem_ancestor.43
	title = "mem_ancestor.43"
	desc = "mem_ancestor.43.desc"
	picture = GFX_evt_black_hole
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_country_flag = mem_ancestor_explosion_notification
		}
	}
	
	immediate = {
		set_country_flag = mem_ancestor_explosion_notification
	}
	
	option = {
		name = "mem_ancestor.43.a"
	}
}

# Notification - Leviathan appears

country_event = {
	id = mem_ancestor.44
	title = "mem_ancestor.44"
	desc = "mem_ancestor.44.desc"
	picture = GFX_evt_wormhole
	show_sound = event_red_alert
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_country_flag = mem_ancestor_crisis_notification
		}
	}
	
	immediate = {
		set_country_flag = mem_ancestor_crisis_notification
	}
	
	option = {
		name = "mem_ancestor.44.a"
	}
}

# Notification - Leviathan evolves

country_event = {
	id = mem_ancestor.45
	title = "mem_ancestor.45"
	desc = "mem_ancestor.45.desc"
	picture = GFX_evt_unspeakable_horror
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_country_flag = mem_ancestor_boss_evolution_notification
		}
	}
	
	immediate = {
		set_country_flag = mem_ancestor_boss_evolution_notification
	}
	
	option = {
		name = "mem_ancestor.45.a"
	}
}

# Notification - Leviathan gives birth

country_event = {
	id = mem_ancestor.46
	title = "mem_ancestor.46"
	desc = "mem_ancestor.46.desc"
	picture = GFX_evt_psionics
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_country_flag = mem_ancestor_boss_birth_notification
		}
	}
	
	immediate = {
		set_country_flag = mem_ancestor_boss_birth_notification
	}
	
	option = {
		name = "mem_ancestor.46.a"
	}
}

country_event = {
	id = mem_ancestor.47
	title = "mem_ancestor.47"
	desc = "mem_ancestor.47.desc"
	picture = GFX_evt_nuclear_explosion
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_country_flag = mem_ancestor_genocide_notification
		}
	}
	
	immediate = {
		set_country_flag = mem_ancestor_genocide_notification
	}
	
	option = {
		name = "mem_ancestor.47.a"
	}
}

country_event = {
	id = mem_ancestor.48
	title = "mem_ancestor.48"
	desc = "mem_ancestor.48.desc"
	picture = GFX_evt_nuclear_explosion
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_country_flag = mem_ancestor_world_bombed
		}
	}
	
	immediate = {
		set_country_flag = mem_ancestor_world_bombed
	}
	
	option = {
		name = "mem_ancestor.48.a"
	}
}

country_event = {
	id = mem_ancestor.49
	title = "mem_ancestor.49"
	desc = "mem_ancestor.49.desc"
	picture = GFX_evt_nuclear_explosion
	
	is_triggered_only = yes
	
	diplomatic = yes
	
	trigger = {
		NOT = {
			has_global_flag = mem_ancestor_sealing_war
		}
	}

	picture_event_data = {
		portrait = event_target:mem_ancestor_fallen
		planet_background = event_target:mem_ancestor_fallen
		graphical_culture = event_target:mem_ancestor_fallen
		city_level = event_target:mem_ancestor_fallen
		room = event_target:mem_ancestor_fallen
	}

	immediate = {
		set_global_flag = mem_ancestor_sealing_war
	}
	
	option = {
		name = "mem_ancestor.49.a"
		response_text = "mem_ancestor.49.a.response"
	}
}

country_event = {
	id = mem_ancestor.50
	hide_window = yes
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_country_type = mem_ancestor_guardian
		has_country_flag = mem_ancestor_country
		FROMFROM = { 
			OR = {
				is_ship_size = mem_apostle_1
				is_ship_size = mem_apostle_2
				is_ship_size = mem_apostle_3
				is_ship_size = mem_apostle_egg
				is_ship_size = mem_apostle_child
			}	
		}
		FROM = {
		is_ai = no 
		}
	}
	
	immediate = {
		FROMFROM = {
			create_ambient_object = {
				type = mem_effect_explosion_8_object
				location = THIS
				duration = 10
				
				use_3d_location = yes
				
				entity_offset = { min = 0 max = 0 }
				entity_offset_angle = { min = 0 max = 0 }
				entity_offset_height = { min = 0 max = 0 }
				
				entity_scale_to_size = yes
				scale = 100
			}
		}
		FROM = {
			country_event = { id = mem_ancestor.51 }
			set_country_flag = mem_ancestor_slayer
		}
		every_planet = {
			if ={
				limit = {
					has_planet_flag = mem_ancestor_world
				}
				every_tile = {
					limit = { has_blocker = "tb_mem_nature" }
					remove_blocker = yes
				}
			}
		}
		every_country = {
			if = {
				limit = { 
					has_modifier = mem_ancestor_weakness
				}
				remove_modifier = "mem_ancestor_weakness"
			}
			if = {
				limit = {
					has_special_project = MEM_ANCESTOR_WEAKNESS_PROJECT
				}
				abort_special_project = {
					type = "MEM_ANCESTOR_WEAKNESS_PROJECT"
					location = capital_scope
				}
			}
		}
		random_country = {
			limit = {
				is_country_type = mem_ancestor_guardian
				has_country_flag = mem_ancestor_country
			}
			every_owned_ship = {
				if = {
					limit = {
						OR = {
							is_ship_size = mem_apostle_scout
							is_ship_size = mem_apostle_station
						}
					}
					fleet ={
						destroy_fleet = this
					}
				}
			}
		}
		add_threat = {
			who = FROM
			amount = 100
		}
	}
}

country_event = {
	id = mem_ancestor.51
	title = "mem_ancestor.51"
	desc = "mem_ancestor.51.desc"
	picture = GFX_evt_small_space_battle
	
	is_triggered_only = yes
	
	option = {
		name = "mem_ancestor.51.a"
	}
}

country_event = {
	id = mem_ancestor.60
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = mem_ancestor_guardian
		
		from = {
			NOT = {
				has_country_flag = mem_ancestor_weakness_check
			}
			is_country_type = default
			is_ai = no
			
			OR = {
				has_country_flag = mem_titan_slayer
				has_country_flag = mem_grave_slayer
				has_country_flag = mem_conduit_slayer
			}
			
			AND = {
				OR = {
					has_technology = "tech_ship_armor_5"
					has_technology = "tech_dragon_armor"
				}
				OR = {
					has_technology = "tech_shields_5"
					has_technology = "tech_enigmatic_deflector"
				}		
				OR = {
					has_technology = "tech_zero_point_power"
					has_technology = "tech_enigmatic_power_core"
				}
				OR = {
					has_technology = "tech_energy_lance_2"
					has_technology = "tech_arc_emitter_2"
					has_technology = "tech_mass_accelerator_2"
				}
			}
		}
	}

	immediate = {
		from = {
			set_country_flag = mem_ancestor_weakness_check
			country_event = { id = mem_ancestor.61 }
		}
	}
}

country_event = {
	id = mem_ancestor.61
	title = "mem_ancestor.61"
	desc = "mem_ancestor.61.desc"
	picture = GFX_evt_exploding_ship
	is_triggered_only = yes

	trigger = {
		NOT = { has_country_flag = mem_ancestor_weakness_researched }
	}

	option = {
		name = mem_ancestor.61.a
		allow = {
			hidden_trigger = {
				NOT = { has_modifier = mem_ancestor_weakness }
			}
		}
		hidden_effect = { set_country_flag = mem_ancestor_weakness_researched }
		capital_scope = { save_event_target_as = mem_pc_home }
		enable_special_project = {
			name = "MEM_ANCESTOR_WEAKNESS_PROJECT"
			location = event_target:mem_pc_home
			owner = ROOT
		}
	}	
	option = {
		name = mem_ancestor.61.b
		add_influence = 100
	}
}

country_event = {
	id = mem_ancestor.62
	title = "mem_ancestor.62"
	desc = "mem_ancestor.62.desc"
	picture = GFX_evt_physics_research
	is_triggered_only = yes

	option = {
		name = mem_ancestor.62.a
		add_modifier = {
			modifier = mem_ancestor_weakness
			days = -1
		}
	}
}

country_event = {
	id = mem_ancestor.70
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = mem_ancestor_guardian
		has_country_flag = mem_ancestor_country
		FROMFROM = {
			has_ship_flag = mem_ancestor_herald_1
			is_ship_size = mem_apostle_scout
		}
	}

	immediate = {
		FROMFROM = {
			mem_effect_explosion_8 = yes
		}
		every_country = {
			limit = { 
				is_country_type = mem_ancestor_guardian
			}
			add_modifier = {
				modifier = "mem_ancestor_herald_debuff_1"
				days = -1
			}
		}
	}
}

country_event = {
	id = mem_ancestor.71
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = mem_ancestor_guardian
		has_country_flag = mem_ancestor_country
		FROMFROM = {
			has_ship_flag = mem_ancestor_herald_2
			is_ship_size = mem_apostle_scout
		}
	}

	immediate = {
		FROMFROM = {
			mem_effect_explosion_8 = yes
		}
		every_country = {
			limit = { 
				is_country_type = mem_ancestor_guardian
			}
			add_modifier = {
				modifier = "mem_ancestor_herald_debuff_2"
				days = -1
			}
		}
	}
}

country_event = {
	id = mem_ancestor.72
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = mem_ancestor_guardian
		has_country_flag = mem_ancestor_country
		FROMFROM = {
			has_ship_flag = mem_ancestor_herald_3
			is_ship_size = mem_apostle_scout
		}
	}

	immediate = {
		FROMFROM = {
			mem_effect_explosion_8 = yes
		}
		every_country = {
			limit = { 
				is_country_type = mem_ancestor_guardian
			}
			add_modifier = {
				modifier = "mem_ancestor_herald_debuff_3"
				days = -1
			}
		}
	}
}

country_event = {
	id = mem_ancestor.73
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = mem_ancestor_guardian
		has_country_flag = mem_ancestor_country
		FROMFROM = {
			has_ship_flag = mem_ancestor_herald_4
			is_ship_size = mem_apostle_scout
		}
	}

	immediate = {
		FROMFROM = {
			mem_effect_explosion_8 = yes
		}
		every_country = {
			limit = { 
				is_country_type = mem_ancestor_guardian
			}
			add_modifier = {
				modifier = "mem_ancestor_herald_debuff_4"
				days = -1
			}
		}
	}
}

country_event = {
	id = mem_ancestor.74
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = mem_ancestor_guardian
		has_country_flag = mem_ancestor_country
		FROMFROM = {
			has_ship_flag = mem_ancestor_herald_5
			is_ship_size = mem_apostle_scout
		}
	}

	immediate = {
		FROMFROM = {
			mem_effect_explosion_8 = yes
		}
		every_country = {
			limit = { 
				is_country_type = mem_ancestor_guardian
			}
			add_modifier = {
				modifier = "mem_ancestor_herald_debuff_5"
				days = -1
			}
		}
	}
}

country_event = {
	id = mem_ancestor.75
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = mem_ancestor_guardian
		has_country_flag = mem_ancestor_country
		FROMFROM = {
			has_ship_flag = mem_ancestor_herald_6
			is_ship_size = mem_apostle_scout
		}
	}

	immediate = {
		FROMFROM = {
			mem_effect_explosion_8 = yes
		}
		every_country = {
			limit = { 
				is_country_type = mem_ancestor_guardian
			}
			add_modifier = {
				modifier = "mem_ancestor_herald_debuff_6"
				days = -1
			}
		}
	}
}
