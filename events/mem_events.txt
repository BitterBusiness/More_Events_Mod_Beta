namespace = BWM_events

# Test Events

country_event = {
	id = BWM_events.1
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "Solar Envoy"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Kether"
					}
					create_ship = {
						name = "Metatron"
						design = last_created_design
						graphical_culture = "fallen_empire_02"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

country_event = {
	id = BWM_events.2
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "Ancient Warform"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Geburah"
					}
					create_ship = {
						name = "Chamuel"
						design = last_created_design
						graphical_culture = "fallen_empire_01"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

country_event = {
	id = BWM_events.3
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "Gravekeeper"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Semias"
					}
					create_ship = {
						name = "Murias"
						design = last_created_design
						graphical_culture = "fallen_empire_04"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

country_event = {
	id = BWM_events.4
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "Awakened Gravekeeper"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Uscias"
					}
					create_ship = {
						name = "Finias"
						design = last_created_design
						graphical_culture = "fallen_empire_04"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

country_event = {
	id = BWM_events.5
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "Providence"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Matet"
					}
					create_ship = {
						name = "Conduit"
						design = last_created_design
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

country_event = {
	id = BWM_events.6
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "The Conduit"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Kheru'ur"
					}
					create_ship = {
						name = "Bulwark"
						design = last_created_design
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

country_event = {
	id = BWM_events.7
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "The Conduit"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Nephtys"
					}
					create_ship = {
						name = "Conduit"
						design = last_created_design
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

country_event = {
	id = BWM_events.8
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "The Conduit"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Seth"
					}
					create_ship = {
						name = "Conduit"
						design = last_created_design
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

country_event = {
	id = BWM_events.9
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "The Conduit"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Osiris"
					}
					create_ship = {
						name = "Conduit"
						design = last_created_design
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

country_event = {
	id = BWM_events.10
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "Providence"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Seqtet"
					}
					create_ship = {
						name = "Conduit"
						design = last_created_design
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

country_event = {
	id = BWM_events.11
    hide_window = yes
	is_triggered_only = yes
#	fire_only_once = yes
	location = root
#	is_triggered_only = yes
	
	trigger = { always = no }

immediate = {
	capital_scope = {
		    create_fleet = {
			    name = "Anchor Station"
				settings = {
				spawn_debris = no 
				is_boss = yes
				}
			    effect = {
					set_owner = ROOT
					create_ship_design = {
						design = "Aten"
					}
					create_ship = {
						name = "Conduit"
						design = last_created_design
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
					set_location = {
						target = PREV
						distance = 45
						angle = random 
					}
				}
			}
		}	
    }
}

# 100 THRONE WATCHERS

# Entering System
ship_event = {
	id = BWM_events.100
	title = "BWM_events.100"
	desc = "BWM_events.100.desc"
	picture = GFX_evt_fallen_empire
	show_sound = event_red_alert
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
		owner = {
			NOT = { has_country_flag = encountered_BWM_titan }
			OR = {
			has_technology = "tech_sensors_4"
			has_technology = "tech_combat_computers_3"
			}
			is_ai = no
		}
		FROM = {
			has_star_flag = BWM_ring_system
			any_ship = { 
				AND = {
					is_ship_size = BWM_titan
					owner = { is_country_type = BWM_ring_guardian_passive }
				}
			}
		}
	}
	
	immediate = {
		FROM = { save_event_target_as = BWM_titan_system }
		owner = { 
			set_country_flag = encountered_BWM_titan
		}
	}		
	
	option = {
		name = BATTLESTATIONS
		hidden_effect = {
			every_country = {
			limit = { 
			is_country_type = BWM_ring_guardian_passive
			}
			set_country_type = BWM_ring_guardian
			}
		}
	}
}

# Guardian defeated (invisible)
country_event = {
	id = BWM_events.101
	hide_window = yes
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_country_type = BWM_ring_guardian
		has_country_flag = BWM_ring_country
		FROMFROM = { is_ship_size = BWM_titan }
		FROM = { is_ai = no }
	}
	
	immediate = {
	    FROMFROM = {
			solar_system = { save_event_target_as = BWM_ring_system }
			create_ambient_object = {
						type = BWM_effect_explosion_2_object
						location = THIS
						duration = 10
						
						use_3d_location = yes
						
						entity_offset = { min = 0 max = 0 }
						entity_offset_angle = { min = 0 max = 0 }
						entity_offset_height = { min = 0 max = 0 }
						
						entity_scale_to_size = yes
						scale = 100
			}
		}
		FROM = {
			country_event = { id = BWM_events.102 }
			set_country_flag = BWM_titan_slayer
			save_event_target_as = BWM_titan_slayer
		}
		every_country = {
			limit = { 
				is_country_type = default
				has_modifier = BWM_ring_weakness
			}
			remove_modifier = "BWM_ring_weakness"
		}
		add_threat = {
			who = FROM
			amount = 10
		}
		destroy_country = yes
	}
}

# Guardian defeated
country_event = {
	id = BWM_events.102
	title = "BWM_events.102"
	desc = "BWM_events.102.desc"
	picture = GFX_evt_small_space_battle
	location = event_target:BWM_ring_system
	
	is_triggered_only = yes
	
	option = {
		name = "BWM_events.102.a"
		event_target:BWM_ring_tomb_moon = {
			enable_special_project = {
				name = "BWM_DECODE"
				location = THIS
				owner = ROOT
			}
		}
	}
}

# Reward
ship_event = {
	id = BWM_events.103
	title = "BWM_events.103"
	desc = "BWM_events.103.desc"
	picture = GFX_evt_sentient_AI
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	immediate = {
		owner = {
		save_event_target_as = BWM_titan_pc_project_owner 
			add_threat = {
				who = owner 
				amount = 10
			}
		}
	}
		
	option = {
		name = "BWM_events.103.a"
		custom_tooltip = BWM_events.103.a.tooltip
		owner = { 
		set_country_flag = BWM_UNLOCK
		}
		create_fleet = {
			name = "Ancient Warform"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = event_target:BWM_titan_pc_project_owner
				create_ship = {
					name = "Chamuel"
					design = "Geburah"
					graphical_culture = "fallen_empire_02"
					prefix = no
				}
				set_location = root
			}
		}
		hidden_effect = {
		if = {
			limit = {
			NOT = { has_global_flag = high_awaken_chance } 
			}
			set_global_flag = high_awaken_chance
			}
			random_system = {
				limit = {
					has_star_flag = BWM_ring_system
				}
				every_system_planet = {
						limit = {
							is_planet_class = pc_BWM_ringworld_shielded
							has_planet_flag = BWM_ring_1
							NOT = { has_planet_flag = BWM_ring_1_unlocked }
							solar_system = {
								NOT = { has_star_flag = BWM_ring_transform }
							}
						}
						change_pc = pc_BWM_ringworld_habitable
						set_planet_flag = BWM_ring_1_unlocked
						set_planet_flag = fallen_empire_world
						set_planet_flag = colony_event

						add_modifier = {
				            modifier = "gaia_world"
				            days = -1
			            }
						add_modifier = {
				            modifier = "natural_beauty"
				            days = -1
			            }
						random_tile = {
				            limit = { has_building = no has_blocker = no num_adjacent_tiles > 3 }
				            set_building = "BWM_building_ancient_ruin_2"
				            add_resource = {
					            resource = minerals
					            amount = 1
					            replace = yes
				            }
				            add_resource = {
					        resource = food
					        amount = 1
					        replace = yes
				            }
                            random_neighboring_tile = {
				                limit = { has_building = no has_blocker = no }
				                set_building = "BWM_building_ancient_ruin_1"
				                add_resource = {
					                resource = food
					                amount = 1
					                replace = yes
				                }				
			                }
				            random_neighboring_tile = {
				                limit = { has_building = no has_blocker = no }
				                set_building = "BWM_building_ancient_ruin_1"
				                add_resource = {
					                resource = food
					                amount = 1
					                replace = yes
				                }				
			                }
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_monolith_0"
				            add_resource = {
					            resource = food
					            amount = 1
					            replace = yes
				            }				
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = engineering_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = society_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = physics_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = engineering_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = society_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = physics_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = engineering_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = society_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = physics_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = engineering_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = society_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = physics_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = engineering_research
					            amount = 1
					            replace = yes
				            }	
			            }			
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = society_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = physics_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = engineering_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = society_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = physics_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = engineering_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = society_research
					            amount = 1
					            replace = yes
				            }	
			            }
			            random_tile = {
				            limit = { has_building = no has_blocker = no }
				            set_building = "BWM_building_ancient_ruin_1"
				            add_resource = {
					            resource = physics_research
					            amount = 1
					            replace = yes
				            }	
			            }
				}
				every_system_planet = {
						limit = {
							is_planet_class = pc_BWM_ringworld_shielded
							has_planet_flag = BWM_ring_2
							NOT = { has_planet_flag = BWM_ring_2_unlocked }
							solar_system = {
								NOT = { has_star_flag = BWM_ring_transform }
							}
						}
						change_pc = pc_BWM_ringworld_habitable
						set_planet_flag = BWM_ring_2_unlocked
						set_planet_flag = fallen_empire_world
						set_planet_flag = colony_event

						add_modifier = {
				            modifier = "gaia_world"
				            days = -1
			            }
						add_modifier = {
				            modifier = "natural_beauty"
				            days = -1
			            }
						random_tile = {
				            limit = { has_building = no has_blocker = no num_adjacent_tiles > 3 }
				            set_building = "BWM_building_ancient_ruin_2"
				            add_resource = {
					            resource = minerals
					            amount = 1
					            replace = yes
				            }
				            add_resource = {
					            resource = food
					            amount = 1
					            replace = yes
				            }
                            random_neighboring_tile = {
				                limit = { has_building = no has_blocker = no }
				                set_building = "BWM_building_ancient_ruin_1"
				                add_resource = {
					                resource = energy
					                amount = 1
					                replace = yes
				                }					
			                }
				            random_neighboring_tile = {
				                limit = { has_building = no has_blocker = no }
				                set_building = "BWM_building_ancient_ruin_1"
				                add_resource = {
					                resource = energy
					                amount = 1
					                replace = yes
				                }					
			                }
							random_neighboring_tile = {
								limit = { has_building = no has_blocker = no }
								set_building = "BWM_building_ancient_ruin_1"
								add_resource = {
									resource = energy
									amount = 1
									replace = yes
								}					
							}
							random_neighboring_tile = {
								limit = { has_building = no has_blocker = no }
								set_building = "BWM_building_ancient_ruin_1"
								add_resource = {
									resource = energy
									amount = 1
									replace = yes
								}					
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = food
								amount = 1
								replace = yes
							}				
						}			
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = food
								amount = 1
								replace = yes
							}				
						}	
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_monolith_0"
							add_resource = {
								resource = food
								amount = 1
								replace = yes
							}				
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}					
						}
				}
				every_system_planet = {
						limit = {
							is_planet_class = pc_BWM_ringworld_shielded
							has_planet_flag = BWM_ring_3
							NOT = { has_planet_flag = BWM_ring_2_unlocked }
							solar_system = {
								NOT = { has_star_flag = BWM_ring_transform }
							}
						}
						change_pc = pc_BWM_ringworld_habitable
						set_planet_flag = BWM_ring_3_unlocked
						set_planet_flag = fallen_empire_world
						set_planet_flag = colony_event
						
						add_modifier = {
				            modifier = "gaia_world"
				            days = -1
			            }
						add_modifier = {
				            modifier = "natural_beauty"
				            days = -1
			            }
						random_tile = {
							limit = { has_building = no has_blocker = no num_adjacent_tiles > 3 }
							set_building = "BWM_building_ancient_ruin_2"
							add_resource = {
								resource = minerals
							    amount = 1
								replace = yes
							}
							add_resource = {
								resource = food
								amount = 1
								replace = yes
							}
							random_neighboring_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
								}	
							}
							random_neighboring_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
								}	
							}
							random_neighboring_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
								}	
							}
							random_neighboring_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
								}	
							}
			            }
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = food
								amount = 1
								replace = yes
							}				
						}			
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = food
								amount = 1
								replace = yes
							}				
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_monolith_0"
							add_resource = {
								resource = food
								amount = 1
								replace = yes
							}				
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}			
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_building = "BWM_building_ancient_ruin_1"
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
				}
				solar_system = { set_star_flag = BWM_ring_transform }
			}
		}
	}
}

#Throne Watcher Research

country_event = {
	id = BWM_events.104
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = BWM_ring_guardian
		any_owned_ship = {
			is_ship_size = BWM_titan	
			fleet = {
				exists = solar_system
				solar_system = {
				has_star_flag = BWM_ring_system
				}
			}	
		}
		
		from = {
			is_country_type = default
			is_ai = no
			any_owned_ship = {
			is_ship_class = shipclass_military 
			fleet = {
					exists = solar_system
					solar_system = {
						has_star_flag = BWM_ring_system
					}
				}	
			}
			OR = {
			has_technology = "tech_shields_5"
			has_technology = "tech_ship_armor_5"
			has_technology = "tech_thrusters_4"
			has_technology = "tech_sensors_4"
			has_technology = "tech_combat_computers_3"
			has_technology = "tech_zero_point_power"
			}
			OR = {
				has_technology = "tech_jump_drive_1"
				has_technology = "tech_psi_jump_drive_1"
				has_technology = "tech_wormhole_generation_3"
			    has_technology = "tech_hyper_drive_3"
			    has_technology = "tech_warp_drive_3"
			}
		}
	}

	immediate = {
		from = {
			country_event = { id = BWM_events.105 }
		}
	}
}

country_event = {
	id = BWM_events.105
	title = "BWM_events.105"
	desc = "BWM_events.105.desc"
	picture = GFX_evt_exploding_ship
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		from = { is_country_type = BWM_ring_guardian }
		is_country_type = default
		is_ai = no
		NOT = { has_country_flag = BWM_ring_weakness_researched }
	}

	option = {
		name = BWM_events.105.a
		allow = {
			energy > 5000 
			minerals > 5000
			hidden_trigger = {
				NOT = { has_modifier = BWM_ring_weakness }
			}
		}
		hidden_effect = { set_country_flag = BWM_ring_weakness_researched }
		capital_scope = { save_event_target_as = BWM_pc_home }
		add_energy = -5000
		add_minerals = -5000
		enable_special_project = {
			name = "BWM_RING_WEAKNESS_PROJECT"
			location = event_target:BWM_pc_home
			owner = ROOT
		}
	}	
	option = {
		name = BWM_events.105.b
		add_influence = 100
	}
}

 country_event = {
	id = BWM_events.106
	title = "BWM_events.106"
	desc = "BWM_events.106.desc"
	picture = GFX_evt_physics_research
	is_triggered_only = yes

	option = {
		name = BWM_events.106.a
		add_modifier = {
			modifier = BWM_ring_weakness
			days = 36000
		}
	}
}

#Bounce

ship_event = {
	id = BWM_events.107
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		owner = {
			NOT = {
			has_country_flag = encountered_BWM_titan
				OR = {
				has_technology = "tech_sensors_4"
				has_technology = "tech_combat_computers_3"
				}
			}
		}
		FROM = {
			has_star_flag = BWM_ring_system
			any_ship = { 
				AND = {
					is_ship_size = BWM_titan
					owner = { is_country_type = BWM_ring_guardian_passive }
				}
			}
		}
	}
	
	immediate = {
		owner = {
			country_event = { id = BWM_events.108 }
		}		
		fleet = {
			order_forced_return = yes
			clear_orders = yes 
		}
	}		
}

country_event = {
	id = BWM_events.108
	title = "BWM_events.108"
	desc = "BWM_events.108.desc"
	picture = GFX_evt_fallen_empire
	location = FROM
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = {
		name = "BWM_events.108.a"
	}
}

# Watcher Upgrade

country_event = {
	id = BWM_events.109
	title = "BWM_events.109"
	desc = "BWM_events.109.desc"
	picture = GFX_evt_unspeakable_horror
	location = ROOT
	
	fire_only_once = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		has_country_flag = BWM_titan_slayer
		any_owned_planet = {
			OR = {
				has_building = "BWM_building_ancient_monolith_1"
				has_building = "BWM_building_ancient_monolith_2"
				has_building = "BWM_building_ancient_monolith_3"
			}
		}
		any_owned_planet = {
			has_building = "BWM_building_ancient_monolith_4"
		}
		any_owned_ship = {
			is_ship_size = BWM_titan_pc
		}
	}
	
	mean_time_to_happen = {
		years = 50
		
		modifier = {
			factor = 0.5
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_1"
				}
		}
		modifier = {
			factor = 0.5
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_2"
				}
				
		}
		modifier = {
			factor = 0.5
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_3"
				}
		}
		modifier = {
			factor = 0.25
			AND = {
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_1"
				}
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_2"
				}
			}
		}
		modifier = {
			factor = 0.25
			AND = {
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_1"
				}
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_3"
				}
			}
		}
		modifier = {
			factor = 0.25
			AND = {
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_2"
				}
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_3"
				}
			}
		}
		modifier = {
			factor = 0.1
			AND = {
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_1"
				}
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_2"
				}
				any_owned_planet = {
					has_building = "BWM_building_ancient_monolith_3"
				}
			}	
		}
	}
	
	immediate = {
		capital_scope = { save_event_target_as = BWM_pc_home }
	}

	option = {
		name = "BWM_events.109.a"
		event_target:BWM_pc_home = {
			enable_special_project = {
				name = "BWM_TITAN_AWAKENING"
				location = THIS
				owner = ROOT
			}
		}
	}
	option = {
		name = "BWM_events.109.b"
		add_influence = 100
	}
}

country_event = {
	id = BWM_events.110
	title = "BWM_events.110"
	desc = "BWM_events.110.desc"
	picture = GFX_evt_ship_in_orbit
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
			is_ai = no
			is_country_type = default
			has_country_flag = BWM_titan_slayer
			NOT = { has_country_flag = BWM_titan_awakening }
			any_owned_ship = {
			is_ship_size = BWM_titan_pc
			}
		}

	option = {
		name = "BWM_events.110.a"
		hidden_effect = { set_country_flag = BWM_titan_awakening }
	}	
}

country_event = {
	id = BWM_events.111
	title = "BWM_events.111"
	desc = "BWM_events.111.desc"
	picture = GFX_evt_small_space_battle
	show_sound = event_mystic_reveal

	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		has_country_flag = BWM_titan_slayer
		has_country_flag = BWM_titan_awakening
		FROMFROM = { is_ship_size = BWM_titan_pc }
	}
	
	immediate = {
		add_threat = {
			who = PREV
			amount = 10
		}
		FROMFROM = {
			save_event_target_as = BWM_titan_pc_spawn
		}
		create_fleet = {
			name = "Solar Envoy"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = PREV
				while = {
					count = 1
					create_ship = {
						name = "Metatron"
						design = "Kether"
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
				}
                set_location = {
					target = event_target:BWM_titan_pc_spawn
					distance = 0
					angle = random
					}	
				}
			}
			last_created_fleet = {
				create_ambient_object = {
					type = BWM_effect_explosion_2_object
					location = THIS
					duration = 10
						
					use_3d_location = yes
						
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
						
					entity_scale_to_size = yes
					scale = 100
				}
			}	
	}
	option = {
		name = "BWM_events.111.a"
	}
}

# 200 GRAVEKEEPER

# ENTER SYSTEM AND PROJECT

ship_event = {
	id = BWM_events.200
	title = "BWM_events.200"
	desc = "BWM_events.200.desc"
	picture = GFX_evt_space_station
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
	    NOT = { has_global_flag = BWM_grave_appeared }
		owner = {
			NOT = { has_country_flag = encountered_BWM_grave }
			is_ai = no
		}
		FROM = {
			has_star_flag = BWM_grave_system
			NOT = { has_star_flag = BWM_grave_defeated }
		}
	}
	
	immediate = {
		FROM = { save_event_target_as = BWM_gravekeeper_system }
		owner = { 
			set_country_flag = encountered_BWM_grave
		}
	}		
	
	option = {
		name = "BWM_events.200.a"
		event_target:BWM_gravekeeper_target = {
			enable_special_project = {
				name = "BWM_GRAVE_EXPLORE"
				location = THIS
				owner = ROOT
			}
		}
	}
}

# GRAVEKEEPER STATION SPAWN
ship_event = {
	id = BWM_events.201
	title = "BWM_events.201"
	desc = "BWM_events.201.desc"
	picture = GFX_evt_sentient_AI
	show_sound = event_activating_unknown_technology
	
	is_triggered_only = yes
	
	option = {
		name = BWM_events.201.a
		custom_tooltip = BWM_events.201.a.tooltip
		owner = { 
			add_physics_research = 1000
			add_society_research = 1000
			add_engineering_research = 1000
		}
		hidden_effect = {
			owner = { 
			country_event = { id = BWM_events.210 }
			}
			event_target:BWM_gravekeeper_system = {
			random_system_ambient_object = {
				limit = { has_ambient_object_flag = BWM_gravekeeper_flag }
				save_event_target_as = BWM_gravekeeper_ambient
			}
		}
		create_country = {
			name = "Forlorn"
			type = BWM_grave_guardian_passive
			flag = {
				icon = {
					category = "blocky"
					file = "flag_blocky_4.dds"
				}
				background= {
					category = "backgrounds"
					file = "00_solid.dds"
				}
				 colors={
						"dark_grey"
						"dark_grey"
						"null"
						"null"
				}
			}
		}
		last_created_country = {
		if = {
				limit = {
					NOT = {
						has_modifier = BWM_grave_power
					}
				}
				add_modifier = {
					modifier = BWM_grave_power
					days = -1
				}
			}
			save_global_event_target_as = BWM_grave_country
			set_country_flag = BWM_grave_country
			set_graphical_culture = fallen_empire_04
			guardian_difficulty = yes
		}
		create_fleet = {
			name = "Gravekeeper"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = event_target:BWM_grave_country
				create_ship = {
					name = "Murias"
					design = "Semias"
					graphical_culture = "fallen_empire_04"
					prefix = no
				}
                set_location = event_target:BWM_gravekeeper_ambient
				save_global_event_target_as = BWM_gravekeeper_spawn
			}
		}
		last_created_fleet = {
			create_ambient_object = {
				type = BWM_effect_explosion_1_object
					location = THIS
					duration = 10
						
					use_3d_location = yes
						
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
						
					entity_scale_to_size = yes
					scale = 10
			}
		}
		event_target:BWM_gravekeeper_ambient = { destroy_ambient_object = this }
		set_global_flag = BWM_grave_appeared
		}
	}

	option = {
		name = BWM_events.201.b
		owner = { 
			add_influence = 100
		}
	}
}

# GRAVEKEEPER ASSAULT MODE (HIDDEN)
country_event = {
	id = BWM_events.202
	hide_window = yes
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_country_type = BWM_grave_guardian
		has_country_flag = BWM_grave_country
		FROMFROM = { is_ship_size = BWM_grave }
		FROM = { is_ai = no }
	}
	
	immediate = {
	    FROMFROM = {
			solar_system = { save_event_target_as = BWM_grave_system }
			create_fleet = {
			name = "Awakened Gravekeeper"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = event_target:BWM_grave_country
				create_ship = {
					name = "Gorias"
					design = "Esras"
					graphical_culture = "fallen_empire_04"
					prefix = no
				}
                set_location = event_target:BWM_gravekeeper_spawn
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = self
				set_aggro_range = 500
				
				queue_actions = {	
						repeat = {
							find_closest_planet  = {
								trigger = {
									id = BWM_grave_awakened.patrol.1
									has_planet_flag = BWM_graveyard_patrol_1
								}
								found_planet = {
									move_to = this
									orbit_planet = this
									wait = {
										duration = 30
									}
								}
							}
							find_closest_planet  = {
								trigger = {
									id = BWM_grave_awakened.patrol.2
									has_planet_flag = BWM_graveyard_patrol_2
								}
								found_planet = {
									move_to = this
									orbit_planet = this
									wait = {
										duration = 30
									}
								}
							}
							find_closest_planet  = {
								trigger = {
									id = BWM_grave_awakened.patrol.3
									has_planet_flag = BWM_graveyard_patrol_3
								}
								found_planet = {
									move_to = this
									orbit_planet = this
									wait = {
										duration = 30
									}
								}
							}	
							find_closest_planet  = {
								trigger = {
									id = BWM_grave_awakened.patrol.6
									has_planet_flag = BWM_graveyard_patrol_4
								}
								found_planet = {
									move_to = this
									orbit_planet = this
									wait = {
										duration = 30
									}
								}
							}	
						}
					}
				}
			}
			last_created_fleet = {
				create_ambient_object = {
					type = BWM_effect_explosion_2_object
					location = THIS
					duration = 10
						
					use_3d_location = yes
						
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
						
					entity_scale_to_size = yes
					scale = 100
				}
			}
		}
		FROM = {
			country_event = { id = BWM_events.203 }
		}
	}
}

# GRAVEKEEPER ASSAULT MODE
country_event = {
	id = BWM_events.203
	title = "BWM_events.203"
	desc = "BWM_events.203.desc"
	picture = GFX_evt_exploding_ship
	show_sound = event_red_alert
	location = event_target:BWM_grave_system
	
	is_triggered_only = yes
	
	option = {
		name = "BWM_events.203.a"
	}
}

# GRAVEKEEPER DISABLED (HIDDEN)
country_event = {
	id = BWM_events.204
	hide_window = yes
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_country_type = BWM_grave_guardian
		has_country_flag = BWM_grave_country
		FROMFROM = { is_ship_size = BWM_grave_awakened }
		FROM = { is_ai = no }
	}
	
	immediate = {
	    FROMFROM  = {
			solar_system = { save_event_target_as = BWM_grave_system }
			create_ambient_object = {
						type = BWM_effect_explosion_5_object
						location = THIS
						duration = 10
						
						use_3d_location = yes
						
						entity_offset = { min = 0 max = 0 }
						entity_offset_angle = { min = 0 max = 0 }
						entity_offset_height = { min = 0 max = 0 }
						
						entity_scale_to_size = yes
						scale = 100
			}
			create_ambient_object = {
			type = "BWM_gravekeeper_pc_object"
			location = THIS
			}
			last_created_ambient_object = { save_global_event_target_as = BWM_disabled_gravekeeper_object }
			create_ambient_object = {
				type = "large_debris_object"
				location = THIS
			}
			last_created_ambient_object = { set_ambient_object_flag = BWM_gravekeeper_debris }
		}
		FROM = {
			country_event = { id = BWM_events.205 }
			set_country_flag = BWM_grave_slayer
			save_event_target_as = BWM_grave_slayer
		}
		every_country = {
			limit = { 
				is_country_type = default
				has_modifier = BWM_grave_weakness
			}
			remove_modifier = "BWM_grave_weakness"
		}
		every_country = {
			country_event = { id = crisis.10 days = 18000 random = 500 }
		}
		add_threat = {
			who = FROM
			amount = 10
		}
		destroy_country = yes
	}
}

# GRAVEKEEPER DISABLED
country_event = {
	id = BWM_events.205
	title = "BWM_events.205"
	desc = "BWM_events.205.desc"
	picture = GFX_evt_small_space_battle
	location = event_target:BWM_grave_system
	
	is_triggered_only = yes
	
	option = {
		name = "BWM_events.205.a"
		event_target:BWM_disabled_gravekeeper_object = {
			enable_special_project = {
				name = "BWM_GRAVE_PC_PROJECT"
				location = THIS
				owner = ROOT
			}
		}
	}
	option = {
		name = "BWM_events.205.b"
		add_minerals = 10000
		add_energy = 10000
		hidden_effect = {
			event_target:BWM_disabled_gravekeeper_object = { destroy_ambient_object = this }
			solar_system = {
				random_system_ambient_object = {
					limit = { has_ambient_object_flag = BWM_gravekeeper_debris }
					destroy_ambient_object = this
				}
			}
		}
	}
}

# GRAVEKEEPER RESTORED
ship_event = {
	id = BWM_events.206
	title = "BWM_events.206"
	desc = "BWM_events.206.desc"
	picture = GFX_evt_ship_in_orbit
	show_sound = event_mystic_reveal
	location = event_target:BWM_grave_system
	
	is_triggered_only = yes
	
	immediate = {
		owner = { save_event_target_as = BWM_grave_project_owner 
				add_threat = {
				who = owner 
				amount = 10
			}
		}
	}
	
	option = {
		name = "BWM_events.206.a"
		create_fleet = {
			name = "Gravekeeper"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = event_target:BWM_grave_project_owner
				create_ship = {
					name = "Finias"
					design = "Fessus"
					graphical_culture = "fallen_empire_04"
					prefix = no
				}
				set_location = {
					target = event_target:BWM_disabled_gravekeeper_object
					distance = 0
					angle = random
				}
			}
		}
		hidden_effect = {
			event_target:BWM_disabled_gravekeeper_object = { destroy_ambient_object = this }
			solar_system = {
				random_system_ambient_object = {
					limit = { has_ambient_object_flag = BWM_gravekeeper_debris }
					destroy_ambient_object = this
				}
			}
		}
	}
}

#Gravekeeper Research

country_event = {
	id = BWM_events.207
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = BWM_grave_guardian
		any_owned_ship = {
		    OR = {
				is_ship_size = BWM_grave
				is_ship_size = BWM_grave_awakened
			}
			fleet = {
				exists = solar_system
				solar_system = {
				has_star_flag = BWM_grave_system
				}
			}
		}
		from = {
			is_country_type = default
			is_ai = no
			any_owned_ship = {
			is_ship_class = shipclass_military 
			fleet = {
					exists = solar_system
					solar_system = {
						has_star_flag = BWM_grave_system
					}
				}	
			}
			OR = {
			has_technology = "tech_shields_5"
			has_technology = "tech_ship_armor_5"
			has_technology = "tech_thrusters_4"
			has_technology = "tech_sensors_4"
			has_technology = "tech_combat_computers_3"
			has_technology = "tech_zero_point_power"
			}
			OR = {
				has_technology = "tech_jump_drive_1"
				has_technology = "tech_psi_jump_drive_1"
				has_technology = "tech_wormhole_generation_3"
			    has_technology = "tech_hyper_drive_3"
			    has_technology = "tech_warp_drive_3"
			}
		}
	}

	immediate = {
		from = {
			country_event = { id = BWM_events.208 }
		}
	}
}

country_event = {
	id = BWM_events.208
	title = "BWM_events.208"
	desc = "BWM_events.208.desc"
	picture = GFX_evt_exploding_ship
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		from = { is_country_type = BWM_grave_guardian }
		is_country_type = default
		is_ai = no
		NOT = { has_country_flag = BWM_grave_weakness_researched }
	}

	option = {
		name = BWM_events.208.a
		allow = {
			energy > 5000 
			minerals > 5000
			hidden_trigger = {
				NOT = { has_modifier = BWM_grave_weakness }
			}
		}
		capital_scope = { save_event_target_as = BWM_pc_home }
		hidden_effect = { set_country_flag = BWM_grave_weakness_researched }
		add_energy = -5000
		add_minerals = -5000
		enable_special_project = {
			name = "BWM_GRAVE_WEAKNESS_PROJECT"
			location = event_target:BWM_pc_home
			owner = ROOT
		}
	}
	option = {
		name = BWM_events.208.b
		add_influence = 100
	}
}

 country_event = {
	id = BWM_events.209
	title = "BWM_events.209"
	desc = "BWM_events.209.desc"
	picture = GFX_evt_physics_research
	is_triggered_only = yes
	
	option = {
		name = BWM_events.209.a

		add_modifier = {
			modifier = BWM_grave_weakness
			days = 36000
		}
	}
}

country_event = {
	id = BWM_events.210
	title = "BWM_events.210"
	desc = "BWM_events.210.desc"
	picture = GFX_evt_sentient_AI
	location = FROM
	
	is_triggered_only = yes
	
	option = {
		name = "BWM_events.210.a"
		hidden_effect = {
			country_event = { id = BWM_events.211 days = 30 }
		}
	}
}

country_event = {
	id = BWM_events.211
	title = "BWM_events.211"
	desc = "BWM_events.211.desc"
	picture = GFX_evt_sentient_AI
	show_sound = event_red_alert
	location = FROM
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = { 
			is_country_type = BWM_grave_guardian_passive
			}
			set_country_type = BWM_grave_guardian
		}
	}
	
	option = {
		name = "BWM_events.211.a"
	}
}

country_event = {
	id = BWM_events.212
	title = "BWM_events.212"
	desc = "BWM_events.212.desc"
	picture = GFX_evt_unspeakable_horror
	location = ROOT
	
	fire_only_once = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		has_country_flag = BWM_grave_slayer
		any_owned_ship = {
			is_ship_size = BWM_grave_awakened_pc_bound
		}
	}
	
	mean_time_to_happen = {
		years = 50

		modifier = {
			factor = 0.5
			has_country_flag = BWM_titan_slayer
		}
		
		modifier = {
			factor = 0.5
			has_country_flag = BWM_conduit_slayer
		}
		
		modifier = {
			factor = 0.1
			AND = {
				has_country_flag = BWM_titan_slayer
				has_country_flag = BWM_conduit_slayer
			}
		}
	}
	
	immediate = {
		capital_scope = { save_event_target_as = BWM_pc_home }
	}
	
	option = {
		name = "BWM_events.212.a"
		event_target:BWM_pc_home = {
			enable_special_project = {
				name = "BWM_GRAVE_AWAKENING"
				location = THIS
				owner = ROOT
			}
		}
	}
	option = {
		name = "BWM_events.212.b"
		add_influence = 100
	}
}

country_event = {
	id = BWM_events.213
	title = "BWM_events.213"
	desc = "BWM_events.213.desc"
	picture = GFX_evt_ship_in_orbit
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
			is_ai = no
			is_country_type = default
			has_country_flag = BWM_grave_slayer
			NOT = { has_country_flag = BWM_grave_awakening }
			any_owned_ship = {
			is_ship_size = BWM_grave_awakened_pc_bound
			}
		}

	option = {
		name = "BWM_events.322.a"
		hidden_effect = { set_country_flag = BWM_grave_awakening }
	}	
}

country_event = {
	id = BWM_events.214
	title = "BWM_events.214"
	desc = "BWM_events.214.desc"
	picture = GFX_evt_small_space_battle
	show_sound = event_mystic_reveal

	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		has_country_flag = BWM_grave_slayer
		has_country_flag = BWM_grave_awakening
		FROMFROM = { is_ship_size = BWM_grave_awakened_pc_bound }
	}
	
	immediate = {
		add_threat = {
			who = PREV
			amount = 10
		}
		FROMFROM = {
			save_event_target_as = BWM_grave_pc_spawn
		}
		create_fleet = {
			name = "Awakened Gravekeeper"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = PREV
				while = {
					count = 1
					create_ship = {
						name = "Finias"
						design = "Uscias"
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
				}
                set_location = {
					target = event_target:BWM_grave_pc_spawn
					distance = 0
					angle = random
					}	
				}
			}
			last_created_fleet = {
				create_ambient_object = {
					type = BWM_effect_explosion_5_object
					location = THIS
					duration = 10
						
					use_3d_location = yes
						
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
						
					entity_scale_to_size = yes
					scale = 100
				}
			}	
	}
	option = {
		name = "BWM_events.214.a"
	}
}

#300 The Conduit

ship_event = {
	id = BWM_events.300
	title = "BWM_events.300"
	desc = "BWM_events.300.desc"
	picture = GFX_evt_ancient_alien_temple
	show_sound = event_mystic_reveal_light
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
		owner = {
			NOT = { has_country_flag = encountered_BWM_conduit }
			NOT = { has_country_flag = BWM_conduit_summon }
			is_ai = no
		}
		FROM = {
			has_star_flag = BWM_garden_system
			NOT = { has_star_flag = BWM_conduit_defeated }
		}
	}
	
	immediate = {
		FROM = { save_event_target_as = BWM_garden_system }
		owner = { 
			set_country_flag = encountered_BWM_conduit
		}
	}		
	
	option = {
		name = "BWM_events.300.a"
		event_target:BWM_shielded_target = {
			enable_special_project = {
				name = "BWM_CONDUIT_UNLOCK"
				location = THIS
				owner = ROOT
			}
		}
	}
}

#Conduit Obelisk 1 Init

planet_event = {
	id = BWM_events.301
	title = "BWM_events.301"
	desc = "BWM_events.301.desc"
	picture = GFX_evt_alien_ruins
	location = ROOT
	
	trigger = {
		has_owner = yes
		is_homeworld = no
		has_planet_flag = BWM_conduit_garden		
		owner = {
			is_ai = no 
			NOT = { has_country_flag = BWM_conduit_garden_country }
		}	
		has_ground_combat = no
		num_pops > 0
		has_building = "BWM_building_obelisk_0"
		NOT = { has_global_flag = BWM_obelisk_1_research_clear }
		NOT = { has_global_flag = BWM_conduit_global }
		NOT = { has_global_flag = BWM_conduit_eye_appeared }
		NOT = { has_planet_flag = BWM_colony_event }
	}

	is_triggered_only = yes
	
	immediate = {
			set_global_flag = BWM_conduit_global
			set_planet_flag = BWM_colony_event
			owner = { set_country_flag = BWM_conduit_garden_country }	
	}
	
	option = {
		name = BWM_events.301.a
		enable_special_project = {
			name = "BWM_OBELISK_1_PROJECT"
			location = root
			owner = root
		}
	}
	
	option = {
		name = BWM_events.301.b
		owner = { 
			add_influence = -100
		}
	}
}

#Conduit Obelisk 2 Init

planet_event = {
	id = BWM_events.302
	title = "BWM_events.302"
	desc = "BWM_events.302.desc"
	picture = GFX_evt_alien_ruins
	location = ROOT

	is_triggered_only = yes

	trigger = {
		owner = {
			is_ai = no
			has_country_flag = BWM_conduit_garden_country
		}
		NOT = { has_global_flag = BWM_obelisk_2_research_clear }
		NOT = { has_global_flag = BWM_conduit_eye_appeared }
		has_planet_flag = BWM_conduit_garden
		has_planet_flag = BWM_colony_event 
		has_building = "BWM_building_obelisk_0"
		has_building = "BWM_building_obelisk_1"
		has_ground_combat = no
		num_pops > 0
	}

	option = {
		name = BWM_events.302.a
		enable_special_project = {
			name = "BWM_OBELISK_2_PROJECT"
			location = root
			owner = root
		}
	}
	
	option = {
		name = BWM_events.302.b
		hidden_effect = {
			every_owned_pop = { 
				add_modifier = {
					modifier = "opinion_disrespected"
					days = 360
				}
			}
		}
		owner = { 
			add_influence = -100
		}
	}
}

#Conduit Obelisk 3 Init

planet_event = {
	id = BWM_events.303
	title = "BWM_events.303"
	desc = "BWM_events.303.desc"
	picture = GFX_evt_alien_ruins
	location = ROOT

	is_triggered_only = yes

	trigger = {
		owner = {
			is_ai = no
			has_country_flag = BWM_conduit_garden_country
		}
		NOT = { has_global_flag = BWM_obelisk_3_research_clear }
		NOT = { has_global_flag = BWM_conduit_eye_appeared }
		has_planet_flag = BWM_conduit_garden
		has_planet_flag = BWM_colony_event
		has_building = "BWM_building_obelisk_0"
		has_building = "BWM_building_obelisk_1"
		has_building = "BWM_building_obelisk_2"		
		has_ground_combat = no
		num_pops > 0
	}

	option = {
		name = BWM_events.303.a
		enable_special_project = {
			name = "BWM_OBELISK_3_PROJECT"
			location = root
			owner = root
		}
	}
	
	option = {
		name = BWM_events.303.b
		hidden_effect = {
			every_owned_pop = { 
				add_modifier = {
					modifier = "opinion_disrespected"
					days = 360
				}
			}
		}
		owner = { 
			add_influence = -100
		}
	}
}

#Conduit Obelisk 4 Init

planet_event = {
	id = BWM_events.304
	title = "BWM_events.304"
	desc = "BWM_events.304.desc"
	picture = GFX_evt_alien_ruins
	location = ROOT

	is_triggered_only = yes

	trigger = {
		owner = {
			is_ai = no
			has_country_flag = BWM_conduit_garden_country
		}
		NOT = { has_global_flag = BWM_obelisk_4_research_clear }
		NOT = { has_global_flag = BWM_conduit_eye_appeared }
		has_planet_flag = BWM_conduit_garden
		has_planet_flag = BWM_colony_event
		has_building = "BWM_building_obelisk_0"
		has_building = "BWM_building_obelisk_1"
		has_building = "BWM_building_obelisk_2"
		has_building = "BWM_building_obelisk_3"
		has_ground_combat = no
		num_pops > 0
	}

	option = {
		name = BWM_events.304.a
		enable_special_project = {
			name = "BWM_OBELISK_4_PROJECT"
			location = root
			owner = root
		}
	}
	
	option = {
		name = BWM_events.304.b
		hidden_effect = {
			every_owned_pop = { 
				add_modifier = {
					modifier = "pop_angered"
					days = 360
				}
			}
		}
		owner = { 
			add_influence = -100
		}
	}
}

#Conduit Obelisk 1 Research Complete

planet_event = {
	id = BWM_events.305
	title = "BWM_events.305"
	desc = "BWM_events.305.desc"
	picture = GFX_evt_medieval_alien_civilization
	location = ROOT

	is_triggered_only = yes

	trigger = {
		owner = {
			is_ai = no
			has_country_flag = BWM_conduit_garden_country
		}
		has_planet_flag = BWM_conduit_garden
		has_planet_flag = BWM_colony_event
		has_building = "BWM_building_obelisk_0"
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		owner = { set_country_flag = BWM_obelisk_init_1 }
		set_global_flag = BWM_obelisk_1_research_clear
	}

	option = {
		name = BWM_events.305.a
	}
}

#Conduit Obelisk 2 Research Complete

planet_event = {
	id = BWM_events.306
	title = "BWM_events.306"
	desc = "BWM_events.306.desc"
	picture = GFX_evt_medieval_alien_civilization
	location = ROOT

	is_triggered_only = yes

	trigger = {
		owner = {
			is_ai = no
			has_country_flag = BWM_conduit_garden_country
		}
		has_planet_flag = BWM_conduit_garden
		has_planet_flag = BWM_colony_event
		has_building = "BWM_building_obelisk_0"
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		owner = { set_country_flag = BWM_obelisk_init_2 }
		set_global_flag = BWM_obelisk_2_research_clear
	}

	option = {
		name = BWM_events.306.a
	}
}

#Conduit Obelisk 3 Research Complete

planet_event = {
	id = BWM_events.307
	title = "BWM_events.307"
	desc = "BWM_events.307.desc"
	picture = GFX_evt_medieval_alien_civilization
	location = ROOT

	is_triggered_only = yes

	trigger = {
		owner = {
			is_ai = no
			has_country_flag = BWM_conduit_garden_country
		}
		has_planet_flag = BWM_conduit_garden
		has_planet_flag = BWM_colony_event
		has_building = "BWM_building_obelisk_0"	
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		owner = { set_country_flag = BWM_obelisk_init_3 }
		set_global_flag = BWM_obelisk_3_research_clear
	}

	option = {
		name = BWM_events.307.a
	}
}

#Conduit Obelisk 4 Research Complete

planet_event = {
	id = BWM_events.308
	title = "BWM_events.308"
	desc = "BWM_events.308.desc"
	picture = GFX_evt_medieval_alien_civilization
	location = ROOT

	is_triggered_only = yes

	trigger = {
		owner = {
			is_ai = no
			has_country_flag = BWM_conduit_garden_country
		}
		has_planet_flag = BWM_conduit_garden
		has_planet_flag = BWM_colony_event
		has_building = "BWM_building_obelisk_0"
		has_ground_combat = no
		num_pops > 0
	}

	immediate = {
		owner = { set_country_flag = BWM_obelisk_init_4 }
		set_global_flag = BWM_obelisk_4_research_clear
	}

	option = {
		name = BWM_events.308.a
	}
}

#Conduit Orbital Obelisk 1

planet_event = {
	id = BWM_events.309
	title = "BWM_events.309"
	desc = "BWM_events.309.desc"
	picture = GFX_evt_psionics
	show_sound = event_mystic_reveal
	location = ROOT
	
	trigger = {
		NOT = { has_global_flag = BWM_conduit_pillar_1_activated }
		NOT = { has_global_flag = BWM_conduit_eye_appeared }
		from = {
			has_building = BWM_building_obelisk_1
		}
	}
	
	is_triggered_only = yes

	immediate = {
			add_threat = {
			who = owner 
			amount = 10
			}
			add_modifier = {
			modifier = "BWM_obelisk_1_mod"
			days = -1
			}
			every_owned_pop = { 
				add_modifier = {
					modifier = "BWM_pop_conduit_1"
					days = -1
				}
			}	
			solar_system = {
			random_system_ambient_object = {
				limit = { has_ambient_object_flag = BWM_conduit_pillar_1 }
				save_event_target_as = BWM_conduit_pillar_1_target
			}
			create_ambient_object = {
				type = "BWM_conduit_on_object"
			}
			last_created_ambient_object = {
				set_location = event_target:BWM_conduit_pillar_1_target
				set_ambient_object_flag = BWM_conduit_pillar_1_on
				save_event_target_as = BWM_conduit_pillar_1_alt
			}
			event_target:BWM_conduit_pillar_1_target = { destroy_ambient_object = this }
		}
		set_global_flag = BWM_conduit_pillar_1_activated
		owner = { set_country_flag = BWM_conduit_1_timer }
		planet_event = { id = BWM_events.302 days = 1800 }
	}
	
	option = {
		name = BWM_events.309.a
	}
}

#Conduit Orbital Obelisk 2

planet_event = {
	id = BWM_events.310
	title = "BWM_events.310"
	desc = "BWM_events.310.desc"
	picture = GFX_evt_psionics
	show_sound = event_mystic_reveal
	location = ROOT
	
	trigger = {
		has_global_flag = BWM_conduit_pillar_1_activated
		NOT = { has_global_flag = BWM_conduit_pillar_2_activated }
		NOT = { has_global_flag = BWM_conduit_eye_appeared }
		from = {
			has_building = BWM_building_obelisk_2
		}
	}
	
	is_triggered_only = yes

	immediate = {
			add_threat = {
			who = owner 
			amount = 10
			}
			add_modifier = {
			modifier = "BWM_obelisk_2_mod"
			days = -1
			}
			every_owned_pop = { 
				add_modifier = {
					modifier = "BWM_pop_conduit_2"
					days = -1
				}
			}
			solar_system = {
			random_system_ambient_object = {
				limit = { has_ambient_object_flag = BWM_conduit_pillar_2 }
				save_event_target_as = BWM_conduit_pillar_2_target
			}
			create_ambient_object = {
				type = "BWM_conduit_on_object"
			}
			last_created_ambient_object = {
				set_location = event_target:BWM_conduit_pillar_2_target
				set_ambient_object_flag = BWM_conduit_pillar_2_on
				save_event_target_as = BWM_conduit_pillar_2_alt
			}
			event_target:BWM_conduit_pillar_2_target = { destroy_ambient_object = this }
		}
		set_global_flag = BWM_conduit_pillar_2_activated
		owner = { set_country_flag = BWM_conduit_2_timer }
		planet_event = { id = BWM_events.303 days = 1800 }
	}
	
	option = {
		name = BWM_events.310.a
	}
}

#Conduit Orbital Obelisk 3

planet_event = {
	id = BWM_events.311
	title = "BWM_events.311"
	desc = "BWM_events.311.desc"
	picture = GFX_evt_psionics
	show_sound = event_mystic_reveal
	location = ROOT
	
	trigger = {
		has_global_flag = BWM_conduit_pillar_1_activated
		has_global_flag = BWM_conduit_pillar_2_activated
		NOT = { has_global_flag = BWM_conduit_eye_appeared }
		NOT = { has_global_flag = BWM_conduit_pillar_3_activated }
		from = {
			has_building = BWM_building_obelisk_3
		}
	}
	
	is_triggered_only = yes

	immediate = {
			add_threat = {
			who = owner 
			amount = 10
			}
			add_modifier = {
			modifier = "BWM_obelisk_3_mod"
			days = -1
			}
			every_owned_pop = { 
				add_modifier = {
					modifier = "BWM_pop_conduit_3"
					days = -1
				}
			}
			solar_system = {
			random_system_ambient_object = {
				limit = { has_ambient_object_flag = BWM_conduit_pillar_3 }
				save_event_target_as = BWM_conduit_pillar_3_target
			}
			create_ambient_object = {
				type = "BWM_conduit_on_object"
			}
			last_created_ambient_object = {
				set_location = event_target:BWM_conduit_pillar_3_target
				set_ambient_object_flag = BWM_conduit_pillar_3_on
				save_event_target_as = BWM_conduit_pillar_3_alt
			}
			event_target:BWM_conduit_pillar_3_target = { destroy_ambient_object = this }	
		}
		set_global_flag = BWM_conduit_pillar_3_activated
		owner = { set_country_flag = BWM_conduit_3_timer }
		planet_event = { id = BWM_events.304 days = 1800 }
	}
	
	option = {
		name = BWM_events.311.a
	}
}

#Conduit Orbital Obelisk 4

planet_event = {
	id = BWM_events.312
	title = "BWM_events.312"
	desc = "BWM_events.312.desc"
	picture = GFX_evt_psionics
	show_sound = event_mystic_reveal
	location = ROOT
	
	trigger = {
		has_global_flag = BWM_conduit_pillar_1_activated
		has_global_flag = BWM_conduit_pillar_2_activated
		has_global_flag = BWM_conduit_pillar_3_activated
		NOT = { has_global_flag = BWM_conduit_eye_appeared }
		NOT = { has_global_flag = BWM_conduit_pillar_4_activated }
		from = {
			has_building = BWM_building_obelisk_4
		}
	}
	
	is_triggered_only = yes

	immediate = {
			add_threat = {
			who = owner 
			amount = 10
			}
			add_modifier = {
			modifier = "BWM_obelisk_4_mod"
			days = -1
			}
			every_owned_pop = { 
				add_modifier = {
					modifier = "BWM_pop_conduit_4"
					days = -1
				}
			}
			solar_system = {
			random_system_ambient_object = {
				limit = { has_ambient_object_flag = BWM_conduit_pillar_4 }
				save_event_target_as = BWM_conduit_pillar_4_target
			}
			create_ambient_object = {
				type = "BWM_conduit_on_object"
			}
			last_created_ambient_object = {
				set_location = event_target:BWM_conduit_pillar_4_target
				set_ambient_object_flag = BWM_conduit_pillar_4_on
				save_event_target_as = BWM_conduit_pillar_4_alt
			}
			event_target:BWM_conduit_pillar_4_target = { destroy_ambient_object = this }
		}
		set_global_flag = BWM_conduit_pillar_4_activated
		owner = { set_country_flag = BWM_conduit_4_timer }
	}
	
	option = {
		name = BWM_events.312.a
	}
}

#Conduit Crisis Init

country_event = {
	id = BWM_events.313
	title = "BWM_events.313"
	desc = "BWM_events.313.desc"
	picture = GFX_evt_unknown_ships
	show_sound = event_activating_unknown_technology
	
	fire_only_once = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		has_country_flag = BWM_conduit_garden_country
		OR = {
			has_global_flag = BWM_conduit_pillar_1_activated
			has_global_flag = BWM_conduit_pillar_2_activated
			has_global_flag = BWM_conduit_pillar_3_activated
			has_global_flag = BWM_conduit_pillar_4_activated
		}
		NOT = { has_global_flag = BWM_conduit_eye_appeared }
	}
	
	mean_time_to_happen = {
		years = 200
		
		modifier = {
			factor = 0.75
			has_country_flag = BWM_conduit_1_timer
		}
		modifier = {
			factor = 0.5
			AND = {
				has_country_flag = BWM_conduit_1_timer
				has_country_flag = BWM_conduit_2_timer
			}
		}
		modifier = {
			factor = 0.25
			AND = {
				has_country_flag = BWM_conduit_1_timer
				has_country_flag = BWM_conduit_2_timer
				has_country_flag = BWM_conduit_3_timer
			}
		}
		modifier = {
			factor = 0.01
			AND = {
				has_country_flag = BWM_conduit_1_timer
				has_country_flag = BWM_conduit_2_timer
				has_country_flag = BWM_conduit_3_timer
				has_country_flag = BWM_conduit_4_timer
			}
		}
	}
	
	immediate = {
			random_system = {
				limit = { has_star_flag = BWM_garden_system }
				random_system_planet = {
				limit = { has_planet_flag = BWM_conduit_garden }
				add_modifier = {
				modifier = "BWM_obelisk_5_mod"
				days = -1
				}
			}
				random_system_planet = {
				limit = { is_star = yes }
				save_event_target_as = BWM_garden_star_locator
			}
			create_ambient_object = {
				type = "BWM_conduit_eye_object"
			}
			last_created_ambient_object = {
				set_location = event_target:BWM_garden_star_locator
				set_ambient_object_flag = BWM_conduit_eye_flag
				save_event_target_as = BWM_conduit_eye_locator
			}
			create_ambient_object = {
						type = BWM_effect_explosion_3_object
						duration = 10
						
						use_3d_location = yes
						
						entity_offset = { min = 0 max = 0 }
						entity_offset_angle = { min = 0 max = 0 }
						entity_offset_height = { min = 0 max = 0 }
						
						entity_scale_to_size = yes
						scale = 5
			}
			last_created_ambient_object = {
				set_location = event_target:BWM_conduit_eye_locator
			}
			save_event_target_as = BWM_conduit_system
		}
		set_global_flag = BWM_conduit_eye_appeared
	}
	
	option = {
		name = BWM_events.313.a
		hidden_effect = { country_event = { id = BWM_events.314 days = 1800 } }
	}
}

#Conduit Crisis Start

country_event = {
	id = BWM_events.314
	title = "BWM_events.314"
	desc = "BWM_events.314.desc"
	picture = GFX_evt_fleet_evil
	show_sound = event_red_alert
	location = event_target:BWM_conduit_system
	
	is_triggered_only = yes
	
	immediate = {
		create_country = {
			name = "The Garden"
			type = BWM_conduit_guardian
			flag = {
				icon = {
					category = "spherical"
					file = "flag_spherical_20.dds"
				}
				background= {
					category = "backgrounds"
					file = "00_solid.dds"
				}
				 colors={
						"dark_brown"
						"dark_brown"
						"null"
						"null"
				}
			}
		}
		last_created_country = {
		if = {
				limit = {
					NOT = {
						has_modifier = BWM_conduit_power
					}
				}
				add_modifier = {
					modifier = BWM_conduit_power
					days = -1
				}
			}
			save_event_target_as = BWM_Seekers
			save_global_event_target_as = BWM_conduit_country
			set_country_flag = BWM_conduit_country
			set_graphical_culture = fallen_empire_03
			guardian_difficulty = yes
		}
		event_target:BWM_conduit_system = {
			random_system_planet = {
				limit = {
					is_planet_class = pc_gaia
					has_planet_flag = BWM_conduit_garden
				}
				set_owner = event_target:BWM_conduit_country
			}
			random_system_ambient_object = {
				limit = { has_ambient_object_flag = BWM_conduit_eye_flag }
				save_event_target_as = BWM_conduit_eye_spawn
			}
			random_neighbor_system = {
				limit = {
					NOT = {
						OR = {
							has_star_flag = BWM_conduit_anchor_2
							has_star_flag = BWM_conduit_anchor_3
							has_star_flag = BWM_conduit_anchor_4
							has_star_flag = BWM_ring_system
							has_star_flag = BWM_grave_system
							has_star_flag = BWM_garden_system
						}
					}
				}
				random_system_planet = {
					limit = {
					is_star = yes 
						NOT = {
							OR = {
								is_planet_class = pc_black_hole 
								is_planet_class = pc_neutron_star
								is_planet_class = pc_pulsar
							}
						}
					}
					save_event_target_as = BWM_conduit_anchor_1_spawn	
				}
				set_star_flag = BWM_conduit_anchor_1
			}
			random_neighbor_system = {
				limit = {
					NOT = {
						OR = {
							has_star_flag = BWM_conduit_anchor_1
							has_star_flag = BWM_conduit_anchor_3
							has_star_flag = BWM_conduit_anchor_4
							has_star_flag = BWM_ring_system
							has_star_flag = BWM_grave_system
							has_star_flag = BWM_garden_system
						}
					}
				}
				random_system_planet = {
					limit = {
					is_star = yes 
						NOT = {
							OR = {
								is_planet_class = pc_black_hole 
								is_planet_class = pc_neutron_star
								is_planet_class = pc_pulsar
							}
						}
					}
					save_event_target_as = BWM_conduit_anchor_2_spawn	
				}
				set_star_flag = BWM_conduit_anchor_2
			}
			random_neighbor_system = {
				limit = {
					NOT = {
						OR = {
							has_star_flag = BWM_conduit_anchor_2
							has_star_flag = BWM_conduit_anchor_1
							has_star_flag = BWM_conduit_anchor_4
							has_star_flag = BWM_ring_system
							has_star_flag = BWM_grave_system
							has_star_flag = BWM_garden_system
						}
					}
				}
				random_system_planet = {
					limit = {
					is_star = yes 
						NOT = {
							OR = {
								is_planet_class = pc_black_hole 
								is_planet_class = pc_neutron_star
								is_planet_class = pc_pulsar
							}
						}
					}
					save_event_target_as = BWM_conduit_anchor_3_spawn	
				}
				set_star_flag = BWM_conduit_anchor_3
			}
			random_neighbor_system = {
				limit = {
					NOT = {
						OR = {
							has_star_flag = BWM_conduit_anchor_2
							has_star_flag = BWM_conduit_anchor_3
							has_star_flag = BWM_conduit_anchor_1
							has_star_flag = BWM_ring_system
							has_star_flag = BWM_grave_system
							has_star_flag = BWM_garden_system
						}
					}
				}
				random_system_planet = {
					limit = {
					is_star = yes 
						NOT = {
							OR = {
								is_planet_class = pc_black_hole 
								is_planet_class = pc_neutron_star
								is_planet_class = pc_pulsar
							}
						}
					}
					save_event_target_as = BWM_conduit_anchor_4_spawn	
				}
				set_star_flag = BWM_conduit_anchor_4
			}
		}
		create_fleet = {
			name = "Eternal Holdfast"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = event_target:BWM_conduit_country
				create_ship = {
					name = "Preserver"
					design = "Aten"
					graphical_culture = "fallen_empire_03"
					prefix = no
				}
				set_location = {
						target = event_target:BWM_conduit_anchor_1_spawn
						distance = 0
						angle = random 
				}
				save_event_target_as = BWM_conduit_anchor_1_locator
			}
		}
		last_created_fleet = {
			create_ambient_object = {
				type = BWM_effect_explosion_4_object
					location = THIS
					duration = 10
						
					use_3d_location = yes
						
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
						
					entity_scale_to_size = yes
					scale = 100
			}
		}
		create_fleet = {
			name = "Eternal Holdfast"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = event_target:BWM_conduit_country
				create_ship = {
					name = "Preserver"
					design = "Aten"
					graphical_culture = "fallen_empire_03"
					prefix = no
				}
				set_location = {
						target = event_target:BWM_conduit_anchor_2_spawn
						distance = 0
						angle = random 
				}
				save_event_target_as = BWM_conduit_anchor_2_locator
			}
		}
		last_created_fleet = {
			create_ambient_object = {
				type = BWM_effect_explosion_4_object
					location = THIS
					duration = 10
						
					use_3d_location = yes
						
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
						
					entity_scale_to_size = yes
					scale = 100
			}
		}
		create_fleet = {
			name = "Eternal Holdfast"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = event_target:BWM_conduit_country
				create_ship = {
					name = "Preserver"
					design = "Aten"
					graphical_culture = "fallen_empire_03"
					prefix = no
				}
				set_location = {
						target = event_target:BWM_conduit_anchor_3_spawn
						distance = 0
						angle = random 
				}
				save_event_target_as = BWM_conduit_anchor_3_locator
			}
		}
		last_created_fleet = {
			create_ambient_object = {
				type = BWM_effect_explosion_4_object
					location = THIS
					duration = 10
						
					use_3d_location = yes
						
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
						
					entity_scale_to_size = yes
					scale = 100
			}
		}
		create_fleet = {
			name = "Eternal Holdfast"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = event_target:BWM_conduit_country
				create_ship = {
					name = "Preserver"
					design = "Aten"
					graphical_culture = "fallen_empire_03"
					prefix = no
				}
				set_location = {
						target = event_target:BWM_conduit_anchor_4_spawn
						distance = 0
						angle = random 
				}
				save_event_target_as = BWM_conduit_anchor_4_locator
			}
		}
		last_created_fleet = {
			create_ambient_object = {
				type = BWM_effect_explosion_4_object
					location = THIS
					duration = 10
						
					use_3d_location = yes
						
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
						
					entity_scale_to_size = yes
					scale = 100
			}
		}
		create_fleet = {
			name = "Eternal Bulwark"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = event_target:BWM_conduit_country
				create_ship = {
					name = "Preserver"
					design = "Kheru'ur"
					graphical_culture = "fallen_empire_03"
					prefix = no
				}
				set_location = {
						target = event_target:BWM_conduit_eye_spawn
						distance = 15
						angle = 45 
				}
				save_event_target_as = BWM_conduit_fortress_spawn
				fleet_event = { id = BWM_events.324 days = 30   } #  Avatar Fleet Arrives - Avatar
				fleet_event = { id = BWM_events.315 days = 360  } #  First Fleet Arrives - Escort
				fleet_event = { id = BWM_events.316 days = 1080 } # Second Fleet Arrives - Cruiser
				fleet_event = { id = BWM_events.317 days = 2160 } #  Third Fleet Arrives - Titan
				fleet_event = { id = BWM_events.315 days = 2520 } #  First Fleet Arrives - Escort
				fleet_event = { id = BWM_events.316 days = 3240 } # Second Fleet Arrives - Cruiser
				fleet_event = { id = BWM_events.317 days = 4320 } #  Third Fleet Arrives - Titan
				fleet_event = { id = BWM_events.315 days = 4680 } #  First Fleet Arrives - Escort
				fleet_event = { id = BWM_events.316 days = 5400 } # Second Fleet Arrives - Cruiser
				fleet_event = { id = BWM_events.317 days = 6480 } #  Third Fleet Arrives - Titan
				fleet_event = { id = BWM_events.315 days = 6840 } #  First Fleet Arrives - Escort
				fleet_event = { id = BWM_events.316 days = 7560 } # Second Fleet Arrives - Cruiser
				fleet_event = { id = BWM_events.317 days = 8640 } #  Third Fleet Arrives - Titan
			}
		}
		last_created_fleet = {
			create_ambient_object = {
				type = BWM_effect_explosion_4_object
					location = THIS
					duration = 10
						
					use_3d_location = yes
						
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
						
					entity_scale_to_size = yes
					scale = 100
			}
		}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}	
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_fortress_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
							
							queue_actions = {
								find_closest_planet  = {
									trigger = {
										id = BWM_conduit_gather.1
										has_planet_flag = BWM_conduit_garden
									}
									found_planet = {
										move_to = this
										orbit_planet = this
									}
								}	
							}
						}
					}
	    create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_fortress_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
							
							queue_actions = {
								find_closest_planet  = {
									trigger = {
										id = BWM_conduit_gather.2
										has_planet_flag = BWM_conduit_garden
									}
									found_planet = {
										move_to = this
										orbit_planet = this
									}
								}	
							}
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_fortress_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
							
							queue_actions = {
								find_closest_planet  = {
									trigger = {
										id = BWM_conduit_gather.3
										has_planet_flag = BWM_conduit_garden
									}
									found_planet = {
										move_to = this
										orbit_planet = this
									}
								}	
							}
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							create_ship = {
								name = "Conduit"
								design = "Seth"
								graphical_culture = "fallen_empire_03"
								prefix = no
							}
							while = {
								count = 5
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_fortress_spawn
								distance = 5
								angle = random
							}
							set_formation_scale = 2.0
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
							
							queue_actions = {
								find_closest_planet  = {
									trigger = {
										id = BWM_conduit_gather.4
										has_planet_flag = BWM_conduit_garden
									}
									found_planet = {
										move_to = this
										orbit_planet = this
									}
								}	
							}
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							create_ship = {
								name = "Conduit"
								design = "Seth"
								graphical_culture = "fallen_empire_03"
								prefix = no
							}
							while = {
								count = 5
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_fortress_spawn
								distance = 5
								angle = random
							}
							set_formation_scale = 2.0
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
							
							queue_actions = {
								find_closest_planet  = {
									trigger = {
										id = BWM_conduit_gather.5
										has_planet_flag = BWM_conduit_garden
									}
									found_planet = {
										move_to = this
										orbit_planet = this
									}
								}	
							}
						}
					}			
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							create_ship = {
								name = "Conduit"
								design = "Osiris"
								graphical_culture = "fallen_empire_03"
								prefix = no
							}
							while = {
								count = 5
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_fortress_spawn
								distance = 5
								angle = random
							}
							set_formation_scale = 2.0
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
							
							queue_actions = {
								find_closest_planet  = {
									trigger = {
										id = BWM_conduit_gather.6
										has_planet_flag = BWM_conduit_garden
									}
									found_planet = {
										move_to = this
										orbit_planet = this
									}
								}	
							}
						}
					}		
		#Anchor 1
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_1_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_1_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							create_ship = {
								name = "Conduit"
								design = "Seth"
								graphical_culture = "fallen_empire_03"
								prefix = no
							}
							while = {
								count = 5
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_1_spawn
								distance = 5
								angle = random
							}
							set_formation_scale = 2.0
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		#Anchor 2
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_2_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_2_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							create_ship = {
								name = "Conduit"
								design = "Seth"
								graphical_culture = "fallen_empire_03"
								prefix = no
							}
							while = {
								count = 5
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_2_spawn
								distance = 5
								angle = random
							}
							set_formation_scale = 2.0
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		#Anchor 3
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_3_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_3_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							create_ship = {
								name = "Conduit"
								design = "Seth"
								graphical_culture = "fallen_empire_03"
								prefix = no
							}
							while = {
								count = 5
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_3_spawn
								distance = 5
								angle = random
							}
							set_formation_scale = 2.0
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		#Anchor 4
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_4_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							while = {
								count = 10
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_4_spawn
								distance = 5
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}
		create_fleet = {
						name = "Eternal Flotilla"
						settings = {
							spawn_debris = no 
							is_boss = yes
						}
						effect = {
							set_owner = event_target:BWM_conduit_country
							create_ship = {
								name = "Conduit"
								design = "Seth"
								graphical_culture = "fallen_empire_03"
								prefix = no
							}
							while = {
								count = 5
								create_ship = {
									name = "Conduit"
									design = "Nephtys"
									graphical_culture = "fallen_empire_03"
									prefix = no
								}	
							}
							set_location = {
								target = event_target:BWM_conduit_anchor_4_spawn
								distance = 5
								angle = random
							}
							set_formation_scale = 2.0
							set_fleet_stance = aggressive
							set_aggro_range = 500
							set_aggro_range_measure_from = self
						}
					}								
		event_target:BWM_conduit_eye_spawn = { destroy_ambient_object = this }
		set_country_flag = BWM_conduit_summon
	}
	
	option = {
		name = "BWM_events.314.a"
	}
}

#Conduit Crisis Fleet 1

fleet_event = {
	id = BWM_events.315
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		event_target:BWM_Seekers = {
			create_fleet = {
				name = "Eternal Flotilla"
				settings = {
					spawn_debris = no 
					is_boss = yes
				}
				effect = {
					set_owner = PREV
					while = {
						count = 10
						create_ship = {
							name = "Conduit"
							design = "Nephtys"
							graphical_culture = "fallen_empire_03"
							prefix = no
						}
					}
					set_location = {
						target = ROOT
						distance = 5
						angle = random
					}
					set_fleet_stance = aggressive
					set_aggro_range = 500
					set_aggro_range_measure_from = self
					
					queue_actions = {
						repeat = {
							find_closest_system = {
								trigger = {
									id = BWM_conduit_roam.1.trigger.1
									NOT = {
										OR = {
											has_star_flag = sanctuary_system
											has_star_flag = hostile_system
											has_star_flag = BWM_ring_system
											has_star_flag = BWM_grave_system
											has_star_flag = BWM_garden_system
											has_star_flag = guardian
										}
									}
								}
								found_system = {
									move_to = this
								}
							}
							find_closest_planet = {
								trigger = {
									id = BWM_conduit_roam.1.trigger.2
									is_star = yes
								}
								found_planet = {
									move_to = this
									orbit_planet = this
									wait = {
										duration = 10
										random = 50
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

#Conduit Crisis Fleet 2

fleet_event = {
	id = BWM_events.316
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		event_target:BWM_Seekers = {
			create_fleet = {
				name = "Eternal Flotilla"
				settings = {
					spawn_debris = no 
					is_boss = yes
				}
				effect = {
					set_owner = PREV
					create_ship = {
						name = "Conduit"
						design = "Seth"
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
					while = {
						count = 5
						create_ship = {
							name = "Conduit"
							design = "Nephtys"
							graphical_culture = "fallen_empire_03"
							prefix = no
						}
					}
					set_location = {
						target = ROOT
						distance = 5
						angle = random
					}
					set_formation_scale = 2.0
					set_fleet_stance = aggressive
					set_aggro_range = 500
					set_aggro_range_measure_from = self
					
					queue_actions = {
						repeat = {
							find_closest_system = {
								trigger = {
									id = BWM_conduit_roam.2.trigger.1
									NOT = {
										OR = {
											has_star_flag = sanctuary_system
											has_star_flag = hostile_system
											has_star_flag = BWM_ring_system
											has_star_flag = BWM_grave_system
											has_star_flag = BWM_garden_system
											has_star_flag = guardian
										}
									}
								}
								found_system = {
									move_to = this
								}
							}
							find_closest_planet = {
								trigger = {
									id = BWM_conduit_roam.2.trigger.2
									is_star = yes
								}
								found_planet = {
									move_to = this
									orbit_planet = this
									wait = {
										duration = 10
										random = 50
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

#Conduit Crisis Fleet 3

fleet_event = {
	id = BWM_events.317
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		event_target:BWM_Seekers = {
			create_fleet = {
				name = "Eternal Flotilla"
				settings = {
					spawn_debris = no 
					is_boss = yes
				}
				effect = {
					set_owner = PREV
					create_ship = {
						name = "Conduit"
						design = "Osiris"
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
					while = {
						count = 5
						create_ship = {
							name = "Conduit"
							design = "Nephtys"
							graphical_culture = "fallen_empire_03"
							prefix = no
						}
					}
					set_location = {
						target = ROOT
						distance = 5
						angle = random
					}
					set_formation_scale = 2.0
					set_fleet_stance = aggressive
					set_aggro_range = 500
					set_aggro_range_measure_from = self
					
					queue_actions = {
						repeat = {
							find_closest_system = {
								trigger = {
									id = BWM_conduit_roam.3.trigger.1
									NOT = {
										OR = {
											has_star_flag = sanctuary_system
											has_star_flag = hostile_system
											has_star_flag = BWM_ring_system
											has_star_flag = BWM_grave_system
											has_star_flag = BWM_garden_system
											has_star_flag = guardian
										}
									}
								}
								found_system = {
									move_to = this
								}
							}
							find_closest_planet = {
								trigger = {
									id = BWM_conduit_roam.3.trigger.2
									is_star = yes
								}
								found_planet = {
									move_to = this
									orbit_planet = this
									wait = {
										duration = 10
										random = 50
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

#Conduit Crisis Clear (Hidden)

country_event = {
	id = BWM_events.318
	hide_window = yes
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_country_type = BWM_conduit_guardian
		has_country_flag = BWM_conduit_country
		FROMFROM = { is_ship_size = BWM_conduit_fortress }
		FROM = { is_ai = no }
	}
	
	immediate = {
		FROM = {
		save_event_target_as = BWM_pc_home
		set_country_flag = BWM_conduit_slayer
		country_event = { id = BWM_events.319 }
		}
	    FROMFROM = {
			create_ambient_object = {
						type = BWM_effect_explosion_4_object
						location = THIS
						duration = 10
						
						use_3d_location = yes
						
						entity_offset = { min = 0 max = 0 }
						entity_offset_angle = { min = 0 max = 0 }
						entity_offset_height = { min = 0 max = 0 }
						
						entity_scale_to_size = yes
						scale = 100
			}
			solar_system = {
				random_system_ambient_object = {
					if = { 
						limit = {
							has_ambient_object_flag = BWM_conduit_pillar_1_on 
						}
						solar_system = {
							random_system_ambient_object = {
								limit = { has_ambient_object_flag = BWM_conduit_pillar_1_on }
								save_event_target_as = BWM_conduit_pillar_1_disable
							}
							create_ambient_object = {
							type = "BWM_conduit_off_object"
							}
							last_created_ambient_object = {
							set_location = event_target:BWM_conduit_pillar_1_disable
							}
							event_target:BWM_conduit_pillar_1_disable = { destroy_ambient_object = this }
						}
					}
				}
				random_system_ambient_object = {
					if = { 
						limit = {
							has_ambient_object_flag = BWM_conduit_pillar_2_on 
						}
						solar_system = {
							random_system_ambient_object = {
								limit = { has_ambient_object_flag = BWM_conduit_pillar_2_on }
								save_event_target_as = BWM_conduit_pillar_2_disable
							}
							create_ambient_object = {
							type = "BWM_conduit_off_object"
							}
							last_created_ambient_object = {
							set_location = event_target:BWM_conduit_pillar_2_disable
							}
							event_target:BWM_conduit_pillar_2_disable = { destroy_ambient_object = this }
						}
					}
				}
				random_system_ambient_object = {
					if = { 
						limit = {
							has_ambient_object_flag = BWM_conduit_pillar_3_on 
						}
						save_event_target_as = BWM_conduit_pillar_3_disable
						solar_system = {
							random_system_ambient_object = {
								limit = { has_ambient_object_flag = BWM_conduit_pillar_3_on }
								save_event_target_as = BWM_conduit_pillar_3_disable
							}
							create_ambient_object = {
							type = "BWM_conduit_off_object"
							}
							last_created_ambient_object = {
							set_location = event_target:BWM_conduit_pillar_3_disable
							}
							event_target:BWM_conduit_pillar_3_disable = { destroy_ambient_object = this }
						}
					}
				}
				random_system_ambient_object = {
					if = { 
						limit = {
							has_ambient_object_flag = BWM_conduit_pillar_4_on 
						}
						save_event_target_as = BWM_conduit_pillar_4_disable
						solar_system = {
							random_system_ambient_object = {
								limit = { has_ambient_object_flag = BWM_conduit_pillar_4_on }
								save_event_target_as = BWM_conduit_pillar_4_disable
							}
							create_ambient_object = {
							type = "BWM_conduit_off_object"
							}
							last_created_ambient_object = {
							set_location = event_target:BWM_conduit_pillar_4_disable
							}
							event_target:BWM_conduit_pillar_4_disable = { destroy_ambient_object = this }
						}
					}
				}
				random_system_planet = {
				limit = {
					is_planet_class = pc_gaia
					has_planet_flag = BWM_conduit_garden
				}
				every_tile = { 
				limit = {
					OR = {
					has_building = "BWM_building_obelisk_0"
					has_building = "BWM_building_obelisk_1"
					has_building = "BWM_building_obelisk_2"
					has_building = "BWM_building_obelisk_3"
					has_building = "BWM_building_obelisk_4"
					}	
				}
				set_building = "building_BWM_obelisk_offline"
				}
				if = {
						limit = { has_modifier = BWM_obelisk_1_mod }
						remove_modifier = BWM_obelisk_1_mod
				}
				if = {
						limit = { has_modifier = BWM_obelisk_2_mod }
						remove_modifier = BWM_obelisk_2_mod
				}
				if = {
						limit = { has_modifier = BWM_obelisk_3_mod }
						remove_modifier = BWM_obelisk_3_mod
				}
				if = {
						limit = { has_modifier = BWM_obelisk_4_mod }
						remove_modifier = BWM_obelisk_4_mod
				}
				if = {
						limit = { has_modifier = BWM_obelisk_5_mod }
						remove_modifier = BWM_obelisk_5_mod
				}
				add_modifier = {
				modifier = "BWM_obelisk_6_mod"
				days = -1
				}
				set_owner = event_target:BWM_pc_home
					every_owned_pop = { 
						add_modifier = {
							modifier = "BWM_pop_conduit_5"
							days = -1
						}
					}
				}
				set_star_flag = BWM_conduit_defeated
				save_event_target_as = BWM_conduit_system 
			}
		}
		every_country = {
			limit = { 
				is_country_type = default
				has_modifier = BWM_conduit_weakness
			}
			remove_modifier = "BWM_conduit_weakness"
		}
		every_country = {
			country_event = { id = crisis.1000 days = 18000 random = 500 }
		}
		add_threat = {
			who = FROM
			amount = 10
		}
		destroy_country = yes
	}
}

#Conduit Crisis Clear

country_event = {
	id = BWM_events.319
	title = "BWM_events.319"
	desc = "BWM_events.319.desc"
	picture = GFX_evt_small_space_battle
	show_sound = event_space_battle
	location = event_target:BWM_conduit_system 
	
	is_triggered_only = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		has_country_flag = BWM_conduit_slayer
	}
	
	immediate = {
		random_system = {
			limit = { has_star_flag = BWM_garden_system }
			random_system_planet = {
				limit = {
					is_planet_class = pc_gaia
					has_planet_flag = BWM_conduit_garden
				}
				save_event_target_as = BWM_garden_aid
			}
		}
	}
	
	option = {
		name = "BWM_events.319.a"
		event_target:BWM_garden_aid = {
			enable_special_project = {
				name = "BWM_GARDEN_HELP"
				location = THIS
				owner = ROOT
			}
		}
	}
}

#Conduit Crisis Timed Reward Init

country_event = {
	id = BWM_events.320
	title = "BWM_events.320"
	desc = "BWM_events.320.desc"
	picture = GFX_evt_molten
	location = event_target:BWM_conduit_system
	
	fire_only_once = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		has_country_flag = BWM_garden_aid_complete
		has_country_flag = BWM_conduit_slayer
		has_country_flag = BWM_conduit_obelisks_destroyed
		has_global_flag = BWM_conduit_molten_global
		OR = {
				has_country_flag = BWM_conduit_fleet_choice_1
				has_country_flag = BWM_conduit_fleet_choice_2
				has_country_flag = BWM_conduit_fleet_choice_3
		}
	}
	
	mean_time_to_happen = {
		years = 100

		modifier = {
			factor = 0.75
			AND = {
				has_global_flag = BWM_conduit_molten_global
				has_country_flag = BWM_conduit_fleet_choice_1
			}
		}
		modifier = {
			factor = 0.75
			AND = {
				has_global_flag = BWM_conduit_molten_global
				has_country_flag = BWM_conduit_fleet_choice_2
			}
		}
		modifier = {
			factor = 0.75
			AND = {
				has_global_flag = BWM_conduit_molten_global
				has_country_flag = BWM_conduit_fleet_choice_3
			}
		}
		modifier = {
			factor = 0.5
			AND = {
				has_global_flag = BWM_conduit_molten_global
				has_country_flag = BWM_conduit_fleet_choice_3
				has_country_flag = BWM_conduit_fleet_choice_1
			}
		}
		modifier = {
			factor = 0.5
			AND = {
				has_global_flag = BWM_conduit_molten_global
				has_country_flag = BWM_conduit_fleet_choice_3
				has_country_flag = BWM_conduit_fleet_choice_2
			}
		}
		modifier = {
			factor = 0.5
			AND = {
				has_global_flag = BWM_conduit_molten_global
				has_country_flag = BWM_conduit_fleet_choice_1
				has_country_flag = BWM_conduit_fleet_choice_2
			}
		}
		modifier = {
			factor = 0.1
			AND = {
				has_global_flag = BWM_conduit_molten_global
				has_country_flag = BWM_conduit_fleet_choice_1
				has_country_flag = BWM_conduit_fleet_choice_2
				has_country_flag = BWM_conduit_fleet_choice_3
			}
		}
	}
	
	immediate = {
		random_system = {
		limit = {
			has_star_flag = BWM_garden_system
		}
		save_event_target_as = BWM_conduit_system	
		random_system_planet = {
			limit = {
				is_planet_class = pc_molten
			}
			save_event_target_as = BWM_garden_molten
			}
		}
	}
	
	option = {
		name = "BWM_events.320.a"
		event_target:BWM_garden_molten = {
			enable_special_project = {
				name = "BWM_LAVA_DIVER"
				location = THIS
				owner = ROOT
			}
		}
	}
	
	option = {
		name = "BWM_events.320.b"
		add_influence = 100
	}
}

#Conduit Crisis Timed Reward

ship_event = {
	id = BWM_events.321
	title = "BWM_events.321"
	desc = "BWM_events.321.desc"
	picture = GFX_evt_ship_in_orbit
	show_sound = event_mystic_reveal_light
	location = event_target:BWM_conduit_system
	
	is_triggered_only = yes
	
	immediate = {
		owner = { save_event_target_as = BWM_conduit_project_owner }
	}
	
	option = { 
		name = "BWM_events.321.a"
		create_fleet = {
			name = "Magma Diver"
			settings = {
				spawn_debris = no 
			}
			effect = {
				set_owner = event_target:BWM_conduit_project_owner
				create_ship = {
					name = "Conduit"
					design = "Seqtet"
					graphical_culture = "fallen_empire_03"
					prefix = no
				}
				set_location = root
			}
		}
	}
	
	option = {
		name = "BWM_events.321.b"
		owner = {
		add_minerals = 5000
		add_energy = 5000
		}
	}
}

#Conduit Crisis Timed Reward Activation

country_event = {
	id = BWM_events.322
	title = "BWM_events.322"
	desc = "BWM_events.322.desc"
	picture = GFX_evt_ship_in_orbit
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
			is_ai = no
			is_country_type = default
			NOT = { has_country_flag = BWM_conduit_avatar_awakening }
			any_owned_ship = {
			is_ship_size = BWM_conduit_avatar_bound
			}
		}

	option = {
		name = "BWM_events.322.a"
		hidden_effect = { set_country_flag = BWM_conduit_avatar_awakening }
	}	
}

#Conduit Crisis Timed Reward Transform

country_event = {
	id = BWM_events.323
	title = "BWM_events.323"
	desc = "BWM_events.323.desc"
	picture = GFX_evt_small_space_battle
	show_sound = event_mystic_reveal

	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		has_country_flag = BWM_conduit_avatar_awakening
		FROMFROM = { is_ship_size = BWM_conduit_avatar_bound }
	}
	
	immediate = {
		add_threat = {
			who = PREV
			amount = 10
		}
		FROMFROM = {
			save_event_target_as = BWM_conduit_avatar_spawn
		}
		create_fleet = {
			name = "Magma Diver"
			settings = {
				spawn_debris = no 
				is_boss = yes
			}
			effect = {
				set_owner = PREV
				while = {
					count = 1
					create_ship = {
						name = "Conduit"
						design = "Matet"
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
				}
                set_location = {
					target = event_target:BWM_conduit_avatar_spawn
					distance = 0
					angle = random
					}	
				}
			}
			last_created_fleet = {
				create_ambient_object = {
					type = BWM_effect_explosion_4_object
					location = THIS
					duration = 10
						
					use_3d_location = yes
						
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
						
					entity_scale_to_size = yes
					scale = 100
				}
			}	
	}
	option = {
		name = "BWM_events.323.a"
	}
}

#Conduit Crisis Final Fleet

fleet_event = {
	id = BWM_events.324
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		event_target:BWM_Seekers = {
			create_fleet = {
				name = "Gatekeeper"
				settings = {
					spawn_debris = no 
					is_boss = yes
				}
				effect = {
					set_owner = PREV
					create_ship = {
						name = "Ulthar"
						design = "Awakened Seeker"
						graphical_culture = "fallen_empire_03"
						prefix = no
					}
					set_location = {
						target = ROOT
						distance = 5
						angle = random
					}
					set_formation_scale = 3.0
					set_fleet_stance = aggressive
					set_aggro_range = 500
					set_aggro_range_measure_from = self
					
					queue_actions = {
						repeat = {
							find_closest_system = {
								trigger = {
									id = BWM_conduit_roam.4.trigger.1
									NOT = {
										OR = {
											has_star_flag = sanctuary_system
											has_star_flag = hostile_system
											has_star_flag = BWM_ring_system
											has_star_flag = BWM_grave_system
											has_star_flag = BWM_garden_system
											has_star_flag = guardian
										}
									}
								}
								found_system = {
									move_to = this
								}
							}
							find_closest_planet = {
								trigger = {
									id = BWM_conduit_roam.4.trigger.2
									is_star = yes
								}
								found_planet = {
									move_to = this
									orbit_planet = this
									wait = {
										duration = 10
										random = 50
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

#Conduit Crisis Research

country_event = {
	id = BWM_events.325
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = BWM_conduit_guardian
		any_owned_ship = {
		    OR = {
				is_ship_size = BWM_conduit_escort
				is_ship_size = BWM_conduit_cruiser
				is_ship_size = BWM_conduit_titan
				is_ship_size = BWM_conduit_fortress
				is_ship_size = BWM_conduit_avatar
				is_ship_size = BWM_conduit_anchor
			}
			fleet = {
				exists = solar_system
				solar_system = {
					OR = {
						has_star_flag = BWM_garden_system
						has_star_flag = BWM_conduit_anchor_1
						has_star_flag = BWM_conduit_anchor_2
						has_star_flag = BWM_conduit_anchor_3
						has_star_flag = BWM_conduit_anchor_4
					}
				}
			}	
		}
		from = {
			is_country_type = default
			is_ai = no
			any_owned_ship = {
			is_ship_class = shipclass_military 
			fleet = {
					exists = solar_system
					solar_system = {
						OR = {
						has_star_flag = BWM_garden_system
						has_star_flag = BWM_conduit_anchor_1
						has_star_flag = BWM_conduit_anchor_2
						has_star_flag = BWM_conduit_anchor_3
						has_star_flag = BWM_conduit_anchor_4
						}
					}
				}	
			}
			OR = {
			has_technology = "tech_shields_5"
			has_technology = "tech_ship_armor_5"
			has_technology = "tech_thrusters_4"
			has_technology = "tech_sensors_4"
			has_technology = "tech_combat_computers_3"
			has_technology = "tech_zero_point_power"
			}
			OR = {
				has_technology = "tech_jump_drive_1"
				has_technology = "tech_psi_jump_drive_1"
				has_technology = "tech_wormhole_generation_3"
			    has_technology = "tech_hyper_drive_3"
			    has_technology = "tech_warp_drive_3"
			}
		}
	}

	immediate = {
		from = {
			country_event = { id = BWM_events.326 }
		}
	}
}

country_event = {
	id = BWM_events.326
	title = "BWM_events.326"
	desc = "BWM_events.326.desc"
	picture = GFX_evt_exploding_ship
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		from = { is_country_type = BWM_conduit_guardian }
		is_country_type = default
		is_ai = no
		NOT = { has_country_flag = BWM_conduit_weakness_researched }
	}

	option = {
		name = BWM_events.326.a
		allow = {
			energy > 5000 
			minerals > 5000
			hidden_trigger = {
				NOT = { has_modifier = BWM_conduit_weakness }
			}
		}
		capital_scope = { save_event_target_as = BWM_pc_home }
		hidden_effect = { set_country_flag = BWM_conduit_weakness_researched }
		add_energy = -5000
		add_minerals = -5000
		enable_special_project = {
			name = "BWM_CONDUIT_WEAKNESS_PROJECT"
			location = event_target:BWM_pc_home
			owner = ROOT
		}
	}
	option = {
		name = BWM_events.326.b
		add_influence = 100
	}
}

 country_event = {
	id = BWM_events.327
	title = "BWM_events.327"
	desc = "BWM_events.327.desc"
	picture = GFX_evt_physics_research
	is_triggered_only = yes
	
	option = {
		name = BWM_events.327.a
		add_modifier = {
			modifier = BWM_conduit_weakness
			days = 36000
		}
	}
}

#Molten modifier

ship_event = {
	id = BWM_events.328
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		from = {
			is_planet_class = pc_molten
			has_planet_flag = BWM_garden_molten
		}
		NOT = { has_global_flag = BWM_conduit_molten_global }
	}
	
	immediate = {
		set_global_flag = BWM_conduit_molten_global
	}
}

country_event = {
	id = BWM_events.329
	title = "BWM_events.329"
	desc = "BWM_events.329.desc"
	picture = GFX_evt_alien_ruins
	location = FROM
	
	fire_only_once = yes
	
	trigger = {
			is_ai = no
			is_country_type = default
			has_country_flag = BWM_conduit_slayer
			any_owned_planet = {
				has_planet_flag = BWM_conduit_garden
				NOT = { has_building = building_BWM_obelisk_offline }
			}
	}

	immediate = {
		random_system = {
			limit = { has_star_flag = BWM_garden_system }
			random_system_planet = {
				limit = { has_planet_flag = BWM_conduit_garden }
				add_modifier = {
							modifier = "BWM_obelisk_7_mod"
							days = -1
				}
			}
		}
		set_country_flag = BWM_conduit_obelisks_destroyed
	}
	
	option = {
		name = BWM_events.329.a
		hidden_effect = { country_event = { id = BWM_events.330 days = 1800 } }
	}
}

country_event = {
	id = BWM_events.330
	title = "BWM_events.330"
	desc = "BWM_events.330.desc"
	picture = GFX_evt_federation_fleet
	show_sound = event_mystic_reveal
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		has_country_flag = BWM_conduit_slayer
		has_country_flag = BWM_conduit_obelisks_destroyed
		NOT = {
			AND = {
				has_country_flag = BWM_conduit_fleet_choice_1
				has_country_flag = BWM_conduit_fleet_choice_2
				has_country_flag = BWM_conduit_fleet_choice_3
			}
		}
	}

	option = {
		name = BWM_events.330.a
		custom_tooltip = BWM_events.330.a.tooltip
		allow = {
			energy > 4000
			minerals > 4000
			hidden_trigger = {
				NOT = { has_country_flag = BWM_conduit_fleet_choice_1 } 
			}	
		}
		random_system = {
			limit = { has_star_flag = BWM_garden_system }
			random_system_planet = {
				limit = { has_planet_flag = BWM_conduit_garden }
				save_event_target_as = BWM_conduit_garden
			}
		}
		hidden_effect = { set_country_flag = BWM_conduit_fleet_choice_1 }
		add_energy = -4000
		add_minerals = -4000
		enable_special_project = {
			name = "BWM_CONDUIT_FLEET_1"
			location = event_target:BWM_conduit_garden
			owner = ROOT
		}
	}
	option = {
		name = BWM_events.330.b
		custom_tooltip = BWM_events.330.b.tooltip
		allow = {
			energy > 6000
			minerals > 6000
			hidden_trigger = {
				NOT = { has_country_flag = BWM_conduit_fleet_choice_2 } 
			}
		}
		random_system = {
			limit = { has_star_flag = BWM_garden_system }
			random_system_planet = {
				limit = { has_planet_flag = BWM_conduit_garden }
				save_event_target_as = BWM_conduit_garden
			}
		}
		hidden_effect = { set_country_flag = BWM_conduit_fleet_choice_2 }
		add_energy = -6000
		add_minerals = -6000
		enable_special_project = {
			name = "BWM_CONDUIT_FLEET_2"
			location = event_target:BWM_conduit_garden
			owner = ROOT
		}
	}
	option = {
		name = BWM_events.330.c
		custom_tooltip = BWM_events.330.c.tooltip
		allow = {
			energy > 8000
			minerals > 8000
			hidden_trigger = {
				NOT = { has_country_flag = BWM_conduit_fleet_choice_3 } 
			}
		}
		random_system = {
			limit = { has_star_flag = BWM_garden_system }
			random_system_planet = {
				limit = { has_planet_flag = BWM_conduit_garden }
				save_event_target_as = BWM_conduit_garden
			}
		}
		hidden_effect = { set_country_flag = BWM_conduit_fleet_choice_3 }
		add_energy = -8000
		add_minerals = -8000
		enable_special_project = {
			name = "BWM_CONDUIT_FLEET_3"
			location = event_target:BWM_conduit_garden
			owner = ROOT
		}
	}
	option = {
		name = BWM_events.330.d
		add_influence = 100
	}
}

#Garden Unlock

ship_event = {
	id = BWM_events.331
	title = "BWM_events.331"
	desc = "BWM_events.331.desc"
	picture = GFX_evt_animal_wildlife
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
		
	option = {
		name = "BWM_events.331.a"
		custom_tooltip = BWM_events.331.a.tooltip
		hidden_effect = {
			random_system = {
				limit = {
					has_star_flag = BWM_garden_system
				}
				random_system_planet = {
						limit = {
							is_planet_class = pc_shielded
							has_planet_flag = BWM_conduit_shielded
							NOT = { has_planet_flag = BWM_conduit_garden }
							solar_system = {
								NOT = { has_star_flag = BWM_garden_unlock }
							}
						}
						change_pc = pc_gaia
						set_planet_flag = BWM_conduit_garden
						set_planet_flag = fallen_empire_world
						set_planet_flag = colony_event
						
						add_modifier = {
							modifier = "BWM_garden_mod"
							days = -1
						}
						random_tile = {
							limit = { has_blocker = no has_building = no num_adjacent_tiles = 2 }
							set_building = "BWM_building_obelisk_0"			
						}
						random_tile = {
							limit = { has_blocker = no has_building = no num_adjacent_tiles = 2 }
							set_building = "BWM_building_obelisk_0"		
						}
						random_tile = {
							limit = { has_blocker = no has_building = no num_adjacent_tiles = 2 }
							set_building = "BWM_building_obelisk_0"	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no num_adjacent_tiles = 2 }
							set_building = "BWM_building_obelisk_0"		
						}
						random_tile = {
							limit = { has_blocker = no has_building = no num_adjacent_tiles > 3 }
							set_building = "BWM_building_ancient_ruin_2"
							add_resource = {
								resource = food
								amount = 1
								replace = yes
							}	
							add_resource = {
								resource = minerals
								amount = 1
							}
							random_neighboring_tile = {
									limit = { has_blocker = no has_building = no }
									set_building = "building_agri_processing_complex"
									add_resource = {
										resource = food
										amount = 1
										replace = yes
								}						
							}
							random_neighboring_tile = {
									limit = { has_blocker = no has_building = no }
									set_building = "building_dark_matter_power_plant"
									add_resource = {
										resource = energy
										amount = 1
										replace = yes
								}						
							}
							random_neighboring_tile = {
									limit = { has_blocker = no has_building = no }
									set_building = "building_dark_matter_power_plant"
									add_resource = {
										resource = energy
										amount = 1
										replace = yes
								}						
							}
							random_neighboring_tile = {
									limit = { has_blocker = no has_building = no }
									set_building = "building_ancient_factory"
									add_resource = {
										resource = minerals
										amount = 1
										replace = yes
								}						
							}				
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_ancient_ruins	
							add_resource = {
								resource = engineering_research
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_ancient_ruins	
							add_resource = {
								resource = society_research
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_ancient_ruins	
							add_resource = {
								resource = physics_research
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_ancient_ruins	
							add_resource = {
								resource = sr_betharian
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = sr_alien_pets
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = engineering_research
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = society_research
								amount = 1
								replace = yes
							}							
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = physics_research
								amount = 1
								replace = yes
							}		
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = food
								amount = 1
								replace = yes
							}		
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = energy
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = minerals
								amount = 1
								replace = yes
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = energy
								amount = 2
								replace = yes
							}
							add_resource = {
								resource = food
								amount = 1
							}		
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = energy
								amount = 2
								replace = yes
							}
							add_resource = {
								resource = food
								amount = 1
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = minerals
								amount = 2
								replace = yes
							}
							add_resource = {
								resource = food
								amount = 1
							}	
						}
						random_tile = {
							limit = { has_building = no has_blocker = no }
							set_blocker = tb_BWM_paradise	
							add_resource = {
								resource = minerals
								amount = 2
								replace = yes
							}
							add_resource = {
								resource = food
								amount = 1
							}	
						}
				}
				solar_system = { set_star_flag = BWM_garden_unlock }
			}
		}
	}
	option = {
		name = "BWM_events.331.b"
		owner = { 
			add_influence = 100
		}
	}
}

ship_event = {
	id = BWM_events.332
	title = "BWM_events.332"
	desc = "BWM_events.332.desc"
	picture = GFX_evt_colony_settlement
	location = FROM

	is_triggered_only = yes

	trigger = {
		owner = {
			is_ai = no
			has_country_flag = BWM_conduit_garden_country
			has_country_flag = BWM_conduit_slayer
			NOT = { has_country_flag = BWM_garden_aid_complete }
		}
	}

	immediate = {
			owner = {
				set_country_flag = BWM_garden_aid_complete
			}
			random_system = {
				limit =  { has_star_flag = BWM_garden_system }
				random_system_planet = {
					limit = { has_planet_flag = BWM_conduit_garden }
					every_owned_pop = {
						if = {
								limit = { has_modifier = BWM_pop_conduit_1 }
								remove_modifier = BWM_pop_conduit_1
						}	
						if = {
								limit = { has_modifier = BWM_pop_conduit_2 }
								remove_modifier = BWM_pop_conduit_2
						}
						if = {
								limit = { has_modifier = BWM_pop_conduit_3 }
								remove_modifier = BWM_pop_conduit_3
						}
						if = {
								limit = { has_modifier = BWM_pop_conduit_4 }
								remove_modifier = BWM_pop_conduit_4
						}
						if = {
								limit = { has_modifier = BWM_pop_conduit_5 }
								remove_modifier = BWM_pop_conduit_5
						}
					}
					if = {
						limit = { has_modifier = BWM_obelisk_6_mod }
						remove_modifier = BWM_obelisk_6_mod
					}
					save_event_target_as = BWM_garden_clear
				}
			}
	}
	option = {
		name = BWM_events.332.a
	}
}

# Conduit Crisis Timed Reward Upgrade Init

country_event = {
	id = BWM_events.333
	title = "BWM_events.333"
	desc = "BWM_events.333.desc"
	picture = GFX_evt_unspeakable_horror
	location = ROOT
	
	fire_only_once = yes
	
	trigger = {
		is_ai = no
		is_country_type = default
		has_country_flag = BWM_conduit_slayer
		has_country_flag = BWM_garden_aid_complete
		any_owned_ship = {
			is_ship_size = BWM_conduit_avatar_bound
		}
	}
	
	mean_time_to_happen = {
		years = 50

		modifier = {
			factor = 0.5
			has_country_flag = BWM_titan_slayer
		}
		
		modifier = {
			factor = 0.5
			has_country_flag = BWM_grave_slayer
		}
		
		modifier = {
			factor = 0.1
			has_country_flag = BWM_titan_slayer
			has_country_flag = BWM_grave_slayer
		}
	}
	
	immediate = {
		capital_scope = { save_event_target_as = BWM_pc_home }
	}

	option = {
		name = "BWM_events.333.a"
		event_target:BWM_pc_home = {
			enable_special_project = {
				name = "BWM_CONDUIT_AWAKENING"
				location = THIS
				owner = ROOT
			}
		}
	}
	option = {
		name = "BWM_events.333.b"
		add_influence = 100
	}
}

ship_event = {
	id = BWM_events.334
	title = "BWM_events.334"
	desc = "BWM_events.334.desc"
	picture = GFX_evt_ship_in_orbit
	show_sound = event_mystic_reveal_light
	location = event_target:BWM_conduit_system
	
	is_triggered_only = yes
	
	trigger = {
		owner = {
			is_ai = no
			is_country_type = default
			has_country_flag = BWM_conduit_fleet_choice_1
		}
	}

	immediate = {
		owner = {
		save_event_target_as = BWM_conduit_fleet_owner 
			add_threat = {
				who = owner
				amount = 10
			}
		}
	}
	
	option = { 
		name = "BWM_events.334.a"
		create_fleet = {
			name = "Eternal Flotilla"
			settings = {
				spawn_debris = no 
			}	
			effect = {
				set_owner = event_target:BWM_conduit_fleet_owner
				while = {
					count = 10
					create_ship = {
						name = "Conduit"
						design = "Nephtys"
						graphical_culture = "fallen_empire_03"
						prefix = no
					}	
				}
				set_location = root
			}
		}
		hidden_effect = {
			owner = {
				country_event = { id = BWM_events.330 days = 1800 }			
			}
		}
	}
	
}

ship_event = {
	id = BWM_events.335
	title = "BWM_events.335"
	desc = "BWM_events.335.desc"
	picture = GFX_evt_ship_in_orbit
	show_sound = event_mystic_reveal_light
	location = event_target:BWM_conduit_system
	
	is_triggered_only = yes
	
	trigger = {
		owner = {
			is_ai = no
			is_country_type = default
			has_country_flag = BWM_conduit_fleet_choice_2
		}
	}
	
	immediate = {
		owner = {
		save_event_target_as = BWM_conduit_fleet_owner 
			add_threat = {
				who = owner
				amount = 10
			}
		}
	}
	
	option = { 
		name = "BWM_events.335.a"
		create_fleet = {
			name = "Eternal Flotilla"
			settings = {
				spawn_debris = no 
			}
			effect = {
				set_owner = event_target:BWM_conduit_fleet_owner
				create_ship = {
					name = "Conduit"
					design = "Seth"
					graphical_culture = "fallen_empire_03"
					prefix = no
				}
				while = {
					count = 5
					create_ship = {
						name = "Conduit"
						design = "Nephtys"
						graphical_culture = "fallen_empire_03"
						prefix = no
					}	
				}
				set_location = root
			}
		}
		hidden_effect = {
			owner = {
				country_event = { id = BWM_events.330 days = 1800 }			
			}
		}
	}
}

ship_event = {
	id = BWM_events.336
	title = "BWM_events.336"
	desc = "BWM_events.336.desc"
	picture = GFX_evt_ship_in_orbit
	show_sound = event_mystic_reveal_light
	location = event_target:BWM_conduit_system
	
	is_triggered_only = yes
	
	trigger = {
		owner = {
			is_ai = no
			is_country_type = default
			has_country_flag = BWM_conduit_fleet_choice_3
		}
	}
	
	immediate = {
		owner = {
		save_event_target_as = BWM_conduit_fleet_owner 
			add_threat = {
				who = owner
				amount = 10
			}
		}
	}
	
	option = { 
		name = "BWM_events.336.a"
		create_fleet = {
			name = "Eternal Flotilla"
			settings = {
				spawn_debris = no 
			}
			effect = {
				set_owner = event_target:BWM_conduit_fleet_owner
				create_ship = {
					name = "Conduit"
					design = "Osiris"
					graphical_culture = "fallen_empire_03"
					prefix = no
				}
				while = {
					count = 5
					create_ship = {
						name = "Conduit"
						design = "Nephtys"
						graphical_culture = "fallen_empire_03"
						prefix = no
					}	
				}
				set_location = root
			}
		}
		hidden_effect = {
			owner = {
				country_event = { id = BWM_events.330 days = 1800 }			
			}
		}
	}
}

country_event = {
	id = BWM_events.337
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = BWM_conduit_guardian
		has_country_flag = BWM_conduit_country
		FROMFROM = {
			is_ship_size = BWM_conduit_anchor
				solar_system = {
					has_star_flag = BWM_conduit_anchor_1
				}
			}
		FROM = { is_ai = no }
	}

	immediate = {
		FROMFROM = {
			create_ambient_object = {
						type = BWM_effect_explosion_4_object
						location = THIS
						duration = 10
						
						use_3d_location = yes
						
						entity_offset = { min = 0 max = 0 }
						entity_offset_angle = { min = 0 max = 0 }
						entity_offset_height = { min = 0 max = 0 }
						
						entity_scale_to_size = yes
						scale = 100
			}
		}
		every_country = {
			limit = { 
				is_country_type = BWM_conduit_guardian
				NOT = { has_modifier = BWM_conduit_anchor_1_debuff }
			}
			add_modifier = {
				modifier = "BWM_conduit_anchor_1_debuff"
				days = -1
			}
		}
	}
}

country_event = {
	id = BWM_events.338
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = BWM_conduit_guardian
		has_country_flag = BWM_conduit_country
		FROMFROM = {
			is_ship_size = BWM_conduit_anchor
				solar_system = {
					has_star_flag = BWM_conduit_anchor_2
				}
			}
		FROM = { is_ai = no }
	}

	immediate = {
		FROMFROM = {
			create_ambient_object = {
						type = BWM_effect_explosion_4_object
						location = THIS
						duration = 10
						
						use_3d_location = yes
						
						entity_offset = { min = 0 max = 0 }
						entity_offset_angle = { min = 0 max = 0 }
						entity_offset_height = { min = 0 max = 0 }
						
						entity_scale_to_size = yes
						scale = 100
			}
		}
		every_country = {
			limit = { 
				is_country_type = BWM_conduit_guardian
				NOT = { has_modifier = BWM_conduit_anchor_2_debuff }
			}
			add_modifier = {
				modifier = "BWM_conduit_anchor_2_debuff"
				days = -1
			}
		}
	}
}

country_event = {
	id = BWM_events.339
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = BWM_conduit_guardian
		has_country_flag = BWM_conduit_country
		FROMFROM = {
			is_ship_size = BWM_conduit_anchor
				solar_system = {
					has_star_flag = BWM_conduit_anchor_3
				}
			}
		FROM = { is_ai = no }
	}

	immediate = {
		FROMFROM = {
			create_ambient_object = {
						type = BWM_effect_explosion_4_object
						location = THIS
						duration = 10
						
						use_3d_location = yes
						
						entity_offset = { min = 0 max = 0 }
						entity_offset_angle = { min = 0 max = 0 }
						entity_offset_height = { min = 0 max = 0 }
						
						entity_scale_to_size = yes
						scale = 100
			}
		}
		every_country = {
			limit = { 
				is_country_type = BWM_conduit_guardian
				NOT = { has_modifier = BWM_conduit_anchor_3_debuff }
			}
			add_modifier = {
				modifier = "BWM_conduit_anchor_3_debuff"
				days = -1
			}
		}
	}
}

country_event = {
	id = BWM_events.340
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = BWM_conduit_guardian
		has_country_flag = BWM_conduit_country
		FROMFROM = {
			is_ship_size = BWM_conduit_anchor
				solar_system = {
					has_star_flag = BWM_conduit_anchor_4
				}
			}
		FROM = { is_ai = no }
	}

	immediate = {
		FROMFROM = {
			create_ambient_object = {
						type = BWM_effect_explosion_4_object
						location = THIS
						duration = 10
						
						use_3d_location = yes
						
						entity_offset = { min = 0 max = 0 }
						entity_offset_angle = { min = 0 max = 0 }
						entity_offset_height = { min = 0 max = 0 }
						
						entity_scale_to_size = yes
						scale = 100
			}
		}
		every_country = {
			limit = { 
				is_country_type = BWM_conduit_guardian
				NOT = { has_modifier = BWM_conduit_anchor_4_debuff }
			}
			add_modifier = {
				modifier = "BWM_conduit_anchor_4_debuff"
				days = -1
			}
		}
	}
}

country_event = {
	id = BWM_events.341
	hide_window = yes
	is_triggered_only = yes
	
	fire_only_once = yes

	trigger = {
		is_country_type = BWM_conduit_guardian
		has_country_flag = BWM_conduit_country
		FROMFROM = {
			is_ship_size = BWM_conduit_avatar
			}
		FROM = { is_ai = no }
	}

	immediate = {
		FROMFROM = {
			create_ambient_object = {
						type = BWM_effect_explosion_4_object
						location = THIS
						duration = 10
						
						use_3d_location = yes
						
						entity_offset = { min = 0 max = 0 }
						entity_offset_angle = { min = 0 max = 0 }
						entity_offset_height = { min = 0 max = 0 }
						
						entity_scale_to_size = yes
						scale = 100
			}
		}
		every_country = {
			limit = { 
				is_country_type = BWM_conduit_guardian
				NOT = { has_modifier = BWM_conduit_avatar_debuff }
			}
			add_modifier = {
				modifier = "BWM_conduit_avatar_debuff"
				days = -1
			}
		}
	}
}